
<!-- saved from url=(0053)http://sdz.tdct.org/sdz/ile-mapping.html#Problmatique -->
<html><!-- Mirrored from 62.4.17.167/sdz/sdz/ile-mapping.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 02:53:25 GMT --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Tutoriel : Tile Mapping</title>
<link href="./Tutoriel _ Tile Mapping_files/sdz_main.css" type="text/css" rel="stylesheet" media="all">
</head>
        <body>
<a href="http://sdz.tdct.org/www.siteduzero.com/informatique/tutoriels/tile-mapping" class="version_en_ligne">Version en ligne</a>
<h1>Tutoriel : Tile Mapping</h1>
<h2>Table des matières</h2><div class="table_des_matieres"><a href="http://sdz.tdct.org/sdz/ile-mapping.html#TileMapping">Tile Mapping</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Prsentationgnrale">Présentation générale</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Problmatique">Problématique</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Techniquedel039imagefige">Technique de l'image figée</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Prsentationdutilemapping">Présentation du tile mapping</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Cotmmoire">Coût mémoire</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Codeexemple">Code exemple</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Propritsdestiles">Propriétés des tiles</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Structured039unfichiertextepourunniveau">Structure d'un fichier texte pour un niveau</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Structuredansleprogramme">Structure dans le programme</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Codeexemple">Code exemple</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Scrolling">Scrolling</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#L039idedel039imagegante">L'idée de l'image géante</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Lefentrage">Le fenêtrage</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Codeexemple">Code exemple</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#UnEditeur">Un Editeur</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Utilisationdel039diteur">Utilisation de l'éditeur</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Simplepersonnage">Simple personnage</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Qu039est-cequ039unpersonnage">Qu'est-ce qu'un personnage ?</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Premireapprochedecollisionavecledcor">Première approche de collision avec le décor</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Algorithmededplacement">Algorithme de déplacement</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Codeexemple">Code exemple</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#InsertiondansunmondedeTiles">Insertion dans un monde de Tiles</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#LanouvellefonctionCollisionDecor">La nouvelle fonction CollisionDecor</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Lesdplacementsrapides">Les déplacements rapides</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Codeexemple">Code exemple</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Scrollingautomatique">Scrolling automatique</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Centredumonde">Centre du monde !</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Scrollingsous-botelimite">Scrolling à sous-boîte limite</a><br><a href="http://sdz.tdct.org/sdz/ile-mapping.html#Codeexemple">Code exemple</a><br></div>
<a name="TileMapping"></a><h2>Tile Mapping</h2><div class="content" role="article">
<p id="r-304305" data-claire-element-id="304305">Ce tutoriel va s'intéresser à la création de jeux de plate-forme, ou jeux en « vue de dessus ». Il présentera et expliquera une technique très utilisée pour ce genre de jeux : le Tile Mapping. Les différents exemples seront proposées en C avec SDL, bien que le but premier soit la compréhension du concept qui permettra de le développer avec n'importe quel langage et n'importe quelle librairie graphique.</p><p id="r-304306" data-claire-element-id="304306">Pour comprendre ce tutoriel, vous aurez besoin :</p><ul id="r-304311" data-claire-element-id="304311"><li id="r-304308" data-claire-element-id="304308"><p id="r-304307" data-claire-element-id="304307">d'avoir bien assimilé les bases de la programmation en C ;</p></li><li id="r-304310" data-claire-element-id="304310"><p id="r-304309" data-claire-element-id="304309">d'avoir déjà utilisé la SDL.</p></li></ul>
</div>
<div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1358423835269-0" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1358423835269-0');
        });
    }
    </script><div id="div-gpt-ad-1358423835269-0" class="megaban"></div>
</div><a name="Prsentationgnrale"></a><h2>Présentation générale</h2><div class="paginate-tuto">
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
<span class="next">Problématique</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div class="content">
<p id="r-304313" data-claire-element-id="304313">Bienvenue dans la première partie de ce tutoriel.</p><p id="r-304314" data-claire-element-id="304314">Dans cette partie, nous allons présenter le Tile Mapping, et faire un petit programme qui affiche un petit monde simple de deux façons différentes :</p><ul id="r-304319" data-claire-element-id="304319"><li id="r-304316" data-claire-element-id="304316"><p id="r-304315" data-claire-element-id="304315">avec des nombres directement dans le code ;</p></li><li id="r-304318" data-claire-element-id="304318"><p id="r-304317" data-claire-element-id="304317">avec un fichier texte comme modèle.</p></li></ul>
</div><a name="Problmatique"></a><h2>Problématique</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">
<span class="arrow"></span>
<span class="next">Présentation générale</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
<span class="next">Technique de l'image figée</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-problematique-1" data-claire-element-id="304364">Problématique</h4><h5 id="r-presentation-62" data-claire-element-id="304331">Présentation</h5><p id="r-304320" data-claire-element-id="304320">Vous avez déjà tous joué à ce qu'on appelle des jeux de plateforme en 2D. Il s'agit de jeux où un personnage court dans un monde, parfois à toute vitesse, saute, monte sur des blocs, et infatigablement continue à courir et à sauter...<br> Pendant que vous courez, l'écran défile. Le monde que vous parcourez peut être plus ou moins grand.</p><p id="r-304321" data-claire-element-id="304321">Un exemple très connu de jeu de plateforme, duquel nous allons nous inspirer, est Super Mario Bros.</p><figure id="r-304323" data-claire-element-id="304324"><img id="r-304322" data-claire-element-id="304322" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_188001_189000_188023.jpg" alt="Image utilisateur"></figure><p id="r-304325" data-claire-element-id="304325">Vous avez surement déjà surement joué aussi a des jeux vus de dessus, comme ce bon vieux Zelda.</p><figure id="r-304327" data-claire-element-id="304328"><img id="r-304326" data-claire-element-id="304326" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_397001_398000_397861.jpg" alt="Image utilisateur"></figure><p id="r-304329" data-claire-element-id="304329">Dans ce tutoriel, nous allons essayer de voir comment de tels jeux sont faits. Comment le monde est mis en place et comment faire défiler l'écran.</p><p id="r-304330" data-claire-element-id="304330">Comment, avec SDL, peut-on arriver à faire un tel type de jeu ? Comment avoir quelque chose de rapide et d'efficace ?</p><h5 id="r-cheminement-du-tutoriel" data-claire-element-id="304363">Cheminement du tutoriel</h5><p id="r-304332" data-claire-element-id="304332">Ce tutoriel devrait grandir au fur et à mesure des versions. Voici ce qu'il pourrait enseigner au fur et à mesure des versions.</p><h6 id="r-presentation-des-techniques" data-claire-element-id="304334">Présentation des techniques.</h6><p id="r-304333" data-claire-element-id="304333">Les jeux de plateforme ont très rapidement adopté la technique du Tile-Mapping, depuis leur plus jeune âge. Je présenterai tout d'abord rapidement une technique pleine d'inconvénients, puis nous passerons sur la technique du tile mapping.</p><h6 id="r-creation-d-un-mini-monde-avec-des-chiffres" data-claire-element-id="304336">Création d'un mini monde avec des chiffres</h6><p id="r-304335" data-claire-element-id="304335">Nous verrons comment créer un petit monde, d'un seul écran, qui ne bouge pas, grâce a un tableau de chiffres.</p><h6 id="r-mise-en-place-de-quelques-proprietes-isolement-du-code" data-claire-element-id="304338">Mise en place de quelques propriétés, isolement du code</h6><p id="r-304337" data-claire-element-id="304337">Pour un jeu de plateformes, il sera important de définir où est le sol, où est le ciel, de façon à ce que par la suite, notre personnage puisse évoluer dans le monde logiquement. <br> Pour un jeu vu de dessus, il sera important de savoir ou on a le droit de marcher, et ou on n'a pas le droit.<br> Les exemples fournis seront découpés en couches de façon à bien isoler la gestion du monde du reste, et qu'il soit facile, avec une seule fonction, d'afficher un niveau.</p><h6 id="r-scrolling" data-claire-element-id="304340">Scrolling</h6><p id="r-304339" data-claire-element-id="304339">Nous verrons ensuite comment faire défiler l'écran (on parle de scrolling), c'est à dire comment faire bouger tout le décor de façon à ce que la caméra suive un personnage, et que le fond défile derrière lui. Tout cela sera également très facile à manipuler au niveau du code.</p><h6 id="r-insertion-d-un-personnage" data-claire-element-id="304342">Insertion d'un personnage</h6><p id="r-304341" data-claire-element-id="304341">Nous verrons finalement en deuxième partie, comment insérer un personnage dans un décor, comment faire en sorte que la caméra le suive automatiquement et comment faire en sorte qu'un mur l'arrête (collisions).</p><h6 id="r-evolution" data-claire-element-id="304362">Evolution</h6><p id="r-304343" data-claire-element-id="304343">A l'heure ou j'écris ces lignes, le plan futur de ce tuto n'est pas encore écrit, mais nous pourrons envisager les points suivants (en fonction de vos commentaires)</p><p id="r-304344" data-claire-element-id="304344">En vrac :</p><ul id="r-304361" data-claire-element-id="304361"><li id="r-304346" data-claire-element-id="304346"><p id="r-304345" data-claire-element-id="304345">des « tiles » animées ;</p></li><li id="r-304348" data-claire-element-id="304348"><p id="r-304347" data-claire-element-id="304347">le scrolling en plusieurs couches (derrière, ça défile moins vite que devant) ;</p></li><li id="r-304350" data-claire-element-id="304350"><p id="r-304349" data-claire-element-id="304349">des objets qu'on pourrait ramasser ;</p></li><li id="r-304352" data-claire-element-id="304352"><p id="r-304351" data-claire-element-id="304351">des ennemis qu'on pourrait insérer ;</p></li><li id="r-304354" data-claire-element-id="304354"><p id="r-304353" data-claire-element-id="304353">plusieurs personnages, avec une caméra intelligente ;</p></li><li id="r-304356" data-claire-element-id="304356"><p id="r-304355" data-claire-element-id="304355">des blocs cassables ;</p></li><li id="r-304358" data-claire-element-id="304358"><p id="r-304357" data-claire-element-id="304357">des pentes, des échelles ;</p></li><li id="r-304360" data-claire-element-id="304360"><p id="r-304359" data-claire-element-id="304359">etc.</p></li></ul>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">
<span class="arrow"></span>
<span class="next">Présentation générale</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
<span class="next">Technique de l'image figée</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Techniquedel039imagefige"></a><h2>Technique de l'image figée</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
<span class="arrow"></span>
<span class="next">Problématique</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
<span class="next">Présentation du tile mapping</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-technique-de-l-image-figee" data-claire-element-id="304375">Technique de l'image figée</h4><p id="r-304365" data-claire-element-id="304365">Avant de parler « Tile Mapping », voici une technique qui pourrait être utilisée pour faire un jeu de plateforme.</p><p id="r-304366" data-claire-element-id="304366">L'idée qui vient à l'esprit tout de suite est de dessiner son monde sous un logiciel de dessin, « Paint » par exemple. L'idée serait de charger l'image au démarrage du programme, de l'afficher en tant que fond d'écran, puis ensuite, d'afficher un Mario par dessus. Les inconvénients sont les suivants.</p><h6 id="r-c-est-couteux-en-memoire" data-claire-element-id="304368">C'est coûteux en mémoire</h6><p id="r-304367" data-claire-element-id="304367">En effet, une grande image, c'est parfois plusieurs mégaoctets de mémoire. Si vous voulez faire un grand monde, multipliez par le nombre d'image nécessaires, et vous obtiendrez une utilisation mémoire inacceptable...</p><h6 id="r-c-est-inexploitable" data-claire-element-id="304374">C'est inexploitable</h6><p id="r-304369" data-claire-element-id="304369">Le plus gros inconvénient est que c'est inexploitable. En effet, si vous affichez votre image de fond, puis que vous affichez Mario, pouvez vous dire facilement si Mario est sur une plateforme ? Dans l'air ? Dans un mur ? Que s'il avance d'un pas, il tombe ?<br> Et non... Vous pouvez éventuellement vous en sortir sur une image ou le fond est uni, mais si vous avez une image de fond comme CastleVania ci dessous, vous ne pouvez pas vous en sortir de cette façon...</p><figure id="r-304371" data-claire-element-id="304372"><img id="r-304370" data-claire-element-id="304370" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_195001_196000_195833.jpg" alt="Image utilisateur"></figure><p id="r-304373" data-claire-element-id="304373">Cette technique a trop d'inconvénients pour être utilisée, je voulais en parler car c'est souvent la première idée qui vient, de "dessiner" son monde, mais nous allons l'oublier, et passer enfin à la technique dont je vous parle depuis tout à l'heure...</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
<span class="arrow"></span>
<span class="next">Problématique</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
<span class="next">Présentation du tile mapping</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Prsentationdutilemapping"></a><h2>Présentation du tile mapping</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
<span class="arrow"></span>
<span class="next">Technique de l'image figée</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
<span class="next">Coût mémoire</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-presentation-du-tile-mapping" data-claire-element-id="304394">Présentation du tile mapping</h4><p id="r-304376" data-claire-element-id="304376">Avant de définir ce qu'est le Tile Mapping, nous allons ensemble regarder quelques images de jeux connus. Comme on dit qu'un schéma en dit plus qu'un long discours, cela devrait nous aider. :)</p><figure id="r-304378" data-claire-element-id="304379"><img id="r-304377" data-claire-element-id="304377" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_188001_189000_188036.jpg" alt="Image utilisateur"></figure><p id="r-304373" data-claire-element-id="304373" alt="Image utilisateur"></figure><figure id="r-304381" data-claire-element-id="304382"><img id="r-304380" data-claire-element-id="304380" src="./Tutoriel _ Tile Mapping_files/zelda.png" alt="Image utilisateur"></figure><p id="r-304383" data-claire-element-id="304383">Quelle est la particularité des cartes de ces jeux ? <br> Et bien nous pouvons constater que des motifs se répètent. En effet, les sols sont des briques identiques, collées les unes à coté des autres. <br> Mieux que ça, on peut remarquer la régularité parfaite de la chose : les points d'interrogation de Mario sont exactement au dessus des briques de sol.</p><p id="r-304384" data-claire-element-id="304384">Pareil, dans Zelda, que nous voyons en dessous, il y a des motifs identiques qui se répètent avec une grande régularité.</p><p id="r-304385" data-claire-element-id="304385">Le concept de Tile Mapping est de coller côte à côte des "tiles" (c'est à dire des tuiles en anglais) dans une zone régulière. Pour cela, nous subdivisons l'écran en une grille régulière, et nous mettrons un carreau dans chaque case.</p><p id="r-304386" data-claire-element-id="304386">Vous voulez voir la grille ?</p><figure id="r-304388" data-claire-element-id="304389"><img id="r-304387" data-claire-element-id="304387" src="./Tutoriel _ Tile Mapping_files/super-mario-bros-grille.jpg" alt="Image utilisateur"></figure><p id="r-304390" data-claire-element-id="304390">Si on regarde bien cette dernière image, et qu'on oublie Mario, l'ennemi, l'étoile, et les nuages, qui sont des <strong>sprites</strong>, nous avons affaire à un décor très régulièrement placé. Chaque brique s'emboîte parfaitement dans la grille.</p><p id="r-304391" data-claire-element-id="304391">Comme déjà dit, chacune de ces petites briques est appelée tuile, ou tile.</p><p id="r-304392" data-claire-element-id="304392">Il y a les tiles uniques, comme les briques et les points d'interrogation, et les tiles composés, comme le pot de fleur, qui est plus gros qu'une case. Cependant, ce pot de fleur, bien qu'il semble être un objet unique, sera vu par la machine comme 8 cases infranchissables...</p><p id="r-304393" data-claire-element-id="304393">L'avantage d'une telle méthode est donc qu'au lieu de définir le monde (considérons qu'il ne bouge pas) par une grande image, on le définit par une grille de 13*15 cases.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
<span class="arrow"></span>
<span class="next">Technique de l'image figée</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
<span class="next">Coût mémoire</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Cotmmoire"></a><h2>Coût mémoire</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
<span class="arrow"></span>
<span class="next">Présentation du tile mapping</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
<span class="next">Code exemple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-cout-memoire" data-claire-element-id="304433">Coût mémoire</h4><p id="r-304395" data-claire-element-id="304395">Nous disions que nous définissons l'image d'au dessus par 13*15 cases.<br> Cela fait 195 cases.</p><p id="r-304396" data-claire-element-id="304396">Combien y a-t-il de tiles différents ?<br> Sur notre image, on a :</p><ul id="r-304405" data-claire-element-id="304405"><li id="r-304398" data-claire-element-id="304398"><p id="r-304397" data-claire-element-id="304397">le bloc ciel ;</p></li><li id="r-304400" data-claire-element-id="304400"><p id="r-304399" data-claire-element-id="304399">le bloc sol ;</p></li><li id="r-304402" data-claire-element-id="304402"><p id="r-304401" data-claire-element-id="304401">le point d'interrogation ;</p></li><li id="r-304404" data-claire-element-id="304404"><p id="r-304403" data-claire-element-id="304403">quatre tiles différents pour le pot de fleurs.</p></li></ul><p id="r-304406" data-claire-element-id="304406">... moins d'une dizaine...</p><p id="r-304407" data-claire-element-id="304407">Nous pouvons imaginer un tableau de 13 * 15 cases qui contiennent un nombre. Si le nombre est 0, on met du "ciel", si le nombre est 1, on met un bloc cassable, si c'est 2, on met un '?', 3 le bord supérieur gauche du pot, 4 le bord supérieur droit, 5 le bord gauche, 6 le bord droit, 7 le sol d'en bas, etc.</p><p id="r-304408" data-claire-element-id="304408">On définit, pour notre Mario, le tableau suivant :</p><pre id="r-304409" data-claire-element-id="304409"><code>000000000000000
000000000000000
000000000000000
000000000000000
100000000111110
000000000000000
000000000000000
000000000000000
003400022220022
005600000000000
005600000000000
005600000000000
777777777777777</code></pre><p id="r-304410" data-claire-element-id="304410">Ce tableau de nombre décrit parfaitement notre monde, car il nous dit, pour chaque case, quel bloc mettre. <br> Vous suivez toujours ?</p><p id="r-304411" data-claire-element-id="304411">Du coup, avec :</p><ul id="r-304416" data-claire-element-id="304416"><li id="r-304413" data-claire-element-id="304413"><p id="r-304412" data-claire-element-id="304412">quelques tiles ;</p></li><li id="r-304415" data-claire-element-id="304415"><p id="r-304414" data-claire-element-id="304414">un tableau de nombres.</p></li></ul><p id="r-304417" data-claire-element-id="304417">On définit un monde ! Schématiquement, cela donne :</p><figure id="r-304419" data-claire-element-id="304420"><img id="r-304418" data-claire-element-id="304418" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_188001_189000_188039.jpg" alt="Image utilisateur"></figure><p id="r-304421" data-claire-element-id="304421">La partie de gauche s'appelle "TileSet". Elle contient les différents carreaux a poser. Ce sont les Tilesets qui définissent le graphisme. Dans mon cas, j'ai fait un tileset d'une seule ligne, mais comme les jeux contiennent quand même davantage de tiles, on définit souvent un tileset sur plusieurs lignes.</p><p id="r-304422" data-claire-element-id="304422">Vous trouverez de nombreux exemple sur google image en cherchant "tileset" !<br> La partie du milieu est le tableau de correspondance. <br> La partie de droite est bien sur le résultat final.</p><p id="r-304423" data-claire-element-id="304423">Revenons maintenant au coût mémoire.</p><p id="r-304424" data-claire-element-id="304424">Pour faire mon monde de Mario, j'ai besoin du tileset (une petite image en soi), et du tableau.<br> Si je considère que je n'aurai pas plus de 256 tiles différents (je tape très large, et c'est souvent le cas), je peux compter 1 octet par case de mon tableau.<br> Avec mon tableau de 13*15, j'ai moins de 200 octets .... C'est très petit.</p><p id="r-304425" data-claire-element-id="304425">Maintenant, supposons un monde entier de Mario (qui défile). Imaginons le monde déplié ainsi :</p><figure id="r-304427" data-claire-element-id="304428"><img id="r-304426" data-claire-element-id="304426" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_188001_189000_188041.gif" alt="Image utilisateur"></figure><p id="r-304429" data-claire-element-id="304429">Combien il y a-t-il de cases la dedans ? A la louche je dirais 300 en largeur, et 20 en hauteur.<br> 300 * 20 = 6000 octets.</p><p id="r-304430" data-claire-element-id="304430">Voilà, le monde tout entier tient sur une image tileset petite, + 6 Ko de données : une cacahuète quoi...</p><p id="r-304431" data-claire-element-id="304431">Et avec ça, on fait un monde grand.<br> C'est ainsi qu'ont procédé les consoles 8 et 16 bits, qui n'avaient pas beaucoup de mémoire.</p><p id="r-304432" data-claire-element-id="304432">Imaginez que si on avait codé tout le monde sous forme d'une graaaande image, on en aurait eu pour des dizaines de MégaOctets, pour une seule "texture", ce qui aurait bien chargé la carte graphique, et qui, outre ceci, aurait été inexploitable par la suite. (nous verrons les avantages du Tile Mapping lorsque nous parlerons de collisions avec le décor.)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
<span class="arrow"></span>
<span class="next">Présentation du tile mapping</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
<span class="next">Code exemple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Codeexemple"></a><h2>Code exemple</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
<span class="arrow"></span>
<span class="next">Coût mémoire</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">
<span class="next">Propriétés des tiles</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-code-exemple" data-claire-element-id="304462">Code exemple</h4><p id="r-304434" data-claire-element-id="304434">L'algorithme n'est pas complexe. Nous définissons, une fois pour toutes, une longueur et une hauteur de tile (qui restera fixe).</p><p id="r-304435" data-claire-element-id="304435">Puis nous faisons un double <code data-claire-semantic="c">for</code> (i,j) sur le tableau, et nous "blittons" le bon tile à la position (i*largeur, j*hauteur).</p><p id="r-304436" data-claire-element-id="304436">Voici l'exemple suivant en C qui reconstruit le petit monde de mario (juste la partie qu'on a étudié)</p><p id="r-304437" data-claire-element-id="304437">Téléchargez et dézippez l'ensemble des fichiers de ce tutoriel ci dessous :</p><p id="r-304438" data-claire-element-id="304438"><a href="http://fvirtman.free.fr/sdz/tilesprogs.zip"><strong>Tous les fichiers</strong></a></p><h6 id="r-explication-sur-les-programmes" data-claire-element-id="304461">Explication sur les programmes</h6><p id="r-304439" data-claire-element-id="304439">Vous pouvez constater que le fichier téléchargé contient plusieurs programmes. Je vous dirais au fur et à mesure du tutoriel quel programme ouvrir.</p><p id="r-304440" data-claire-element-id="304440">Chaque programme a été fait avec Visual C++ 2008 express, mais pourra être compilé avec d'autres versions, avec code::blokcs, gcc, etc...<br> Si vous ouvrez le répertoire prog1, en dessous, vous avez un autre répertoire prog1, ainsi qu'un fichier .sln. Si vous avez visual C++, double cliquez sur le sln : le projet d'ouvre et est prêt à compiler.<br> Sinon, ouvrez le sous répertoire prog1. Vous voyez un .vcproj (également pour Visual C++), et les sources et images utilisées.<br> Tous les projets sont faits de la même façon.</p><aside id="r-304442" data-claire-element-id="304442" data-claire-semantic="information"><p id="r-304441" data-claire-element-id="304441">Ouvrez maintenant le projet prog1.</p></aside><p id="r-304443" data-claire-element-id="304443">Vous pouvez le compiler, et le lancer, ça doit marcher tout seul. (je rappelle que vous devez avoir de bonnes bases en C, et avec la librairie SDL pour poursuivre ce tutoriel).</p><p id="r-304444" data-claire-element-id="304444"><strong>prog1.c</strong></p><pre id="r-304445" data-claire-element-id="304445"><code data-claire-semantic="c">#include &lt;SDL/SDL.h&gt;

#pragma comment (lib,"sdl.lib")      // ignorez ces lignes si vous ne linkez pas les libs de cette façon.
#pragma comment (lib,"sdlmain.lib")

#define LARGEUR_TILE 24  // hauteur et largeur des tiles.
#define HAUTEUR_TILE 16 

#define NOMBRE_BLOCS_LARGEUR 15  // nombre a afficher en x et y
#define NOMBRE_BLOCS_HAUTEUR 13

char* table[] = {
"000000000000000",
"000000000000000",
"000000000000000",
"000000000000000",
"100000000111110",
"000000000000000",
"000000000000000",
"000000000000000",
"003400022220022",
"005600000000000",
"005600000000000",
"005600000000000",
"777777777777777"};


void Afficher(SDL_Surface* screen,SDL_Surface* tileset,char** table,int nombre_blocs_largeur,int nombre_blocs_hauteur)
{
	int i,j;
	SDL_Rect Rect_dest;
	SDL_Rect Rect_source;
	Rect_source.w = LARGEUR_TILE;
	Rect_source.h = HAUTEUR_TILE;
	for(i=0;i&lt;nombre_blocs_largeur;i++)
	{
		for(j=0;j&lt;nombre_blocs_hauteur;j++)
		{
			Rect_dest.x = i*LARGEUR_TILE;
			Rect_dest.y = j*HAUTEUR_TILE;
			Rect_source.x = (table[j][i]-'0')*LARGEUR_TILE;
			Rect_source.y = 0;
			SDL_BlitSurface(tileset,&amp;Rect_source,screen,&amp;Rect_dest);
		}
	}
	SDL_Flip(screen);
}

int main(int argc,char** argv)
{
	SDL_Surface* screen,*tileset;
	SDL_Event event;
	SDL_Init(SDL_INIT_VIDEO);		// prepare SDL
	screen = SDL_SetVideoMode(LARGEUR_TILE*NOMBRE_BLOCS_LARGEUR, HAUTEUR_TILE*NOMBRE_BLOCS_HAUTEUR, 32,SDL_HWSURFACE|SDL_DOUBLEBUF);
	tileset = SDL_LoadBMP("tileset1.bmp");
	if (!tileset)
	{
		printf("Echec de chargement tileset1.bmp\n");
		SDL_Quit();
		system("pause");
		exit(-1);
	}
	Afficher(screen,tileset,table,NOMBRE_BLOCS_LARGEUR,NOMBRE_BLOCS_HAUTEUR);

	do  // attend qu'on appuie sur une touche.
	{
		SDL_WaitEvent(&amp;event);
	} while (event.type!=SDL_KEYDOWN);
	
	SDL_FreeSurface(tileset);
	SDL_Quit();
	return 0;
}</code></pre><p id="r-304446" data-claire-element-id="304446">Le code n'est pas complexe : <br> Je veux afficher une image de 15*13 tiles (NOMBRE_BLOCS_LARGEUR et NOMBRE_BLOCS_HAUTEUR dans les #define).<br> Chaque tile fait 24*16 pixels (définis dans LARGEUR_TILE et HAUTEUR_TILE).</p><p id="r-304447" data-claire-element-id="304447">Dans le main, j'initialise SDL, la taille de l'image finale, obtenue en faisant l'opération nombre de cases en X * taille d'un tile, et pareil pour y, bien entendu. :) <br> Je charge le tileset, et je lance la fonction afficher. J'attends qu'on appuie sur une touche pour quitter.</p><p id="r-304448" data-claire-element-id="304448">Dans la fonction afficher, je définis 2 SDL_Rect, celui de destination dont vous avez l'habitude, et celui source qui sera passé en 2e paramètre de SDL_BlitSurface pour un blit Partiel.</p><p id="r-304449" data-claire-element-id="304449">Je fixe Rect_source.w et .h une fois pour toutes, car les tiles auront toujours la même largeur et la même hauteur.<br> Puis ensuite, je fais un double for. Je fixe Rect_dest.x et y à la bonne position (qui dépend de i et de j), puis je définis Rect_dest.x, qui lui dépend directement du nombre correspondant. (nous allons détailler cette ligne ci dessous).<br> Rect_source.y est lui toujours a 0, car dans mon tileset, tous les tiles partent de y=0.</p><p id="r-304450" data-claire-element-id="304450">Détaillons la ligne suivante :</p><pre id="r-304451" data-claire-element-id="304451"><code data-claire-semantic="c">Rect_source.x = (table[j][i]-'0')*LARGEUR_TILE;</code></pre><p id="r-304452" data-claire-element-id="304452">Nous avons le tableau table défini, en dur, en haut du code.<br> Nous voulons récupérer le chiffre à la colonne i, ligne j.<br> D'ou l'idée de faire table[i][j].</p><p id="r-304453" data-claire-element-id="304453">Cependant, vous remarquerez je j'y mis [j][i] et non [i][j]. Cela vient de la définition même du tableau dans le code. <br> Prenons l'exemple avec des mots plutôt que des chiffres :</p><pre id="r-304454" data-claire-element-id="304454"><code data-claire-semantic="c">char* table[] = {
"Bonjour",
"Salut!!",
"Hello!!",
"Saloute",
"Hola!!!"
}</code></pre><p id="r-304455" data-claire-element-id="304455">Si vous choisissez table[1], vous avez "Salut", puis table[1][2] pour avoir le 'l' de Salut.<br> Donc la lecture d'un tableau de chaîne se fait en ligne/colonne, alors que nous attendons colonne/ligne dans un repère 2D, d'où la transposée [j][i] au lieu de [i][j].</p><p id="r-304456" data-claire-element-id="304456">Maintenant, deuxième soucis, pourquoi est ce que je fais -'0' ?<br> Si je prends table[j][i], je tombe sur un nombre, mais sur un caractère, sur le code ASCII de '1', celui de '0' etc...</p><p id="r-304457" data-claire-element-id="304457">Or le code ASCII de '0' vaut 48. Moi je ne veux pas 48, je veux 0. En soustrayant '0' à un chiffre en ASCII, on obtient le chiffre réel. C'est une astuce classique, sachant que les chiffres sont contiguës dans la table ASCII.</p><p id="r-304458" data-claire-element-id="304458">Et voilà, nous avons notre monde de Mario, à partir du tileset et de la table de correspondance. Heureux ?</p><p id="r-304459" data-claire-element-id="304459">(J'ai peut être inversé 2 tiles dans mon dessin, mais bon... )</p><p id="r-304460" data-claire-element-id="304460">Respirez, et repensez à ce concept à tête reposée. L'essentiel est surtout de comprendre l'idée. Le code va peu à peu évoluer, et surtout se retrouver enfermé dans un autre fichier de façon à vous fournir des fonctions puissantes et simples à utiliser.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
<span class="arrow"></span>
<span class="next">Coût mémoire</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">
<span class="next">Propriétés des tiles</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Propritsdestiles"></a><h2>Propriétés des tiles</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
<span class="arrow"></span>
<span class="next">Code exemple</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
<span class="next">Structure d'un fichier texte pour un niveau</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div class="content">
<p id="r-304464" data-claire-element-id="304464">Dans ce chapitre, nous allons voir comment lire un niveau depuis un fichier texte, et nous allons aussi parler des propriétés des tiles.</p>
</div><a name="Structured039unfichiertextepourunniveau"></a><h2>Structure d'un fichier texte pour un niveau</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">
<span class="arrow"></span>
<span class="next">Propriétés des tiles</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
<span class="next">Structure dans le programme</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-structure-d-un-fichier-texte-pour-un-niveau" data-claire-element-id="304493">Structure d'un fichier texte pour un niveau</h4><p id="r-304465" data-claire-element-id="304465">L'inconvénient de l'exemple précédent, c'est qu'on entrait directement le niveau dans le code. Si on veut faire des niveaux supplémentaire, ça devient assez contraignant.</p><p id="r-304466" data-claire-element-id="304466">Nous allons donc nous appuyer sur un fichier texte que nous allons structurer.</p><aside id="r-304468" data-claire-element-id="304468" data-claire-semantic="information"><p id="r-304467" data-claire-element-id="304467">Ouvrez le répertoire prog2.</p></aside><p id="r-304469" data-claire-element-id="304469">Dedans, vous trouvez un fichier appelé level.txt, ouvrez le avec un bloc note.</p><pre id="r-304470" data-claire-element-id="304470"><code>Tilemapping&nbsp;Version&nbsp;1.0
#tileset
tileset1.bmp
8&nbsp;1
tile0:&nbsp;vide
tile1:&nbsp;plein
tile2:&nbsp;plein
tile3:&nbsp;plein
tile4:&nbsp;plein
tile5:&nbsp;plein
tile6:&nbsp;plein
tile7:&nbsp;plein
#level
15&nbsp;13
0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0
0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0
0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0
0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0
1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;1&nbsp;1&nbsp;1&nbsp;0
0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0
0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0
0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0
0&nbsp;0&nbsp;3&nbsp;4&nbsp;0&nbsp;0&nbsp;0&nbsp;2&nbsp;2&nbsp;2&nbsp;2&nbsp;0&nbsp;0&nbsp;2&nbsp;2
0&nbsp;0&nbsp;5&nbsp;6&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0
0&nbsp;0&nbsp;5&nbsp;6&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0
0&nbsp;0&nbsp;5&nbsp;6&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0
7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7
#fin</code></pre><p id="r-304471" data-claire-element-id="304471">Expliquons ce fichier.<br> Tout d'abord, vous pouvez constater que la première ligne est juste une ligne qui donne la version.</p><p id="r-304472" data-claire-element-id="304472">Ensuite, nous voyons que le fichier est découpé en 2 blocs :</p><ul id="r-304477" data-claire-element-id="304477"><li id="r-304474" data-claire-element-id="304474"><p id="r-304473" data-claire-element-id="304473">#tileset ;</p></li><li id="r-304476" data-claire-element-id="304476"><p id="r-304475" data-claire-element-id="304475">#level.</p></li></ul><h6 id="r-le-bloc-tileset" data-claire-element-id="304486">Le bloc tileset</h6><p id="r-304478" data-claire-element-id="304478">Sous le bloc #tileset, ce sont les informations sur le tileset. Avec tout d'abord le nom du tileset à charger : tileset1.bmp.</p><figure id="r-304480" data-claire-element-id="304481"><img id="r-304479" data-claire-element-id="304479" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_397001_398000_397871.png" alt="Image utilisateur"></figure><p id="r-304482" data-claire-element-id="304482">Ensuite, la ligne suivante contient "8 1". Je définis simplement combien on a de tiles en X, et combien en Y. L'image contient 8 tiles, tous sur la même ligne, donc 8 en X, 1 en Y.<br> Notez que grâce à la taille de l'image, et du nombre de tiles lus, on peut calculer la largeur et la hauteur d'un tile avec une simple division.</p><p id="r-304483" data-claire-element-id="304483">Ensuite, voici la nouveauté de ce chapitre. Comme je l'ai évoqué plus haut, il va falloir définir pour chaque tile s'il est plein ou vide, pour les futurs calculs du jeu.</p><p id="r-304484" data-claire-element-id="304484">Typiquement, pour un Mario, seul le premier tile (du ciel) est vide : les personnages pourront s'y promener. Tous les autres sont pleins : on ne pourra pas les traverser.<br> Pour un Zelda, on aurait en tiles vides tous les sols sur lesquels on peut marcher, et en tiles pleins tous les tiles de rochers, d'arbres, de murs.</p><p id="r-304485" data-claire-element-id="304485">C'est ce qu'on appellera les propriétés des tiles. On pourra plus tard en mettre d'autres.</p><h6 id="r-le-bloc-level" data-claire-element-id="304492">Le bloc level</h6><p id="r-304487" data-claire-element-id="304487">Le bloc level contient d'abord le nombre de tiles en x et y du level (15 et 13), puis directement le tableau qui définit le level, comme dans le premier chapitre.</p><p id="r-304488" data-claire-element-id="304488">Notez cependant que cette fois ci, je mets des espaces entre chaque chiffre. Pourquoi ? Tout simplement parce qu'avec la version du chapitre précédent, nous étions bloqués si nous avions plus de 10 tiles.</p><p id="r-304489" data-claire-element-id="304489">Ici, pas de soucis, on pourra très bien avoir 200 tiles et écrire :</p><pre id="r-304490" data-claire-element-id="304490"><code>0&nbsp;&nbsp;&nbsp;150&nbsp;&nbsp;1&nbsp;8&nbsp;
101&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;6&nbsp;2</code></pre><p id="r-304491" data-claire-element-id="304491">La balise "fin" explicitera la fin du fichier.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">
<span class="arrow"></span>
<span class="next">Propriétés des tiles</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
<span class="next">Structure dans le programme</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Structuredansleprogramme"></a><h2>Structure dans le programme</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
<span class="arrow"></span>
<span class="next">Structure d'un fichier texte pour un niveau</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
<span class="next">Code exemple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-structure-dans-le-programme" data-claire-element-id="304526">Structure dans le programme</h4><p id="r-304494" data-claire-element-id="304494">Maintenant que nous avons vu comment était codé notre fichier texte, voyons comment nous allons ranger ça en mémoire.</p><pre id="r-304495" data-claire-element-id="304495"><code data-claire-semantic="c">typedef unsigned char tileindex;

typedef struct
{
	SDL_Rect R;
	int plein;
} TileProp;

typedef struct
{
	int LARGEUR_TILE,HAUTEUR_TILE;
	int nbtilesX,nbtilesY;
	SDL_Surface* tileset;
	TileProp* props;
	tileindex** schema;
	int nbtiles_largeur_monde,nbtiles_hauteur_monde;
} Map;</code></pre><h5 id="r-la-structure-map" data-claire-element-id="304512">La structure Map</h5><p id="r-304496" data-claire-element-id="304496">Regardons d'abord la structure Map, qui contiendra tout pour nous afficher le monde.</p><ul id="r-304509" data-claire-element-id="304509"><li id="r-304498" data-claire-element-id="304498"><p id="r-304497" data-claire-element-id="304497">LARGEUR_TILE, HAUTEUR_TILE : les noms parlent d'eux mêmes.</p></li><li id="r-304500" data-claire-element-id="304500"><p id="r-304499" data-claire-element-id="304499">nbtilesX,nbtilesY : nombre de tiles dans le tileset, en x et y. Dans notre cas, ce sera 8 et 1.</p></li><li id="r-304502" data-claire-element-id="304502"><p id="r-304501" data-claire-element-id="304501">nbtiles_largeur_monde,nbtiles_hauteur_monde : garderont les 15 et 13 de notre exemple.</p></li><li id="r-304504" data-claire-element-id="304504"><p id="r-304503" data-claire-element-id="304503">tileset : lien vers la surface tileset chargée.</p></li><li id="r-304506" data-claire-element-id="304506"><p id="r-304505" data-claire-element-id="304505">props : Un tableau de propriétés pour chaque tile. Sa taille sera nbtilesX*nbtilesY. L'élément du tableau est une autre structure, TileProp, que nous allons voir plus bas.</p></li><li id="r-304508" data-claire-element-id="304508"><p id="r-304507" data-claire-element-id="304507">schema: Tableau à deux dimensions, qui contiendra tous les chiffres de la partie "level". Sa taille sera nbtiles_largeur_monde en X, nbtiles_hauteur_monde en Y.</p></li></ul><h6 id="r-le-type-tileindex" data-claire-element-id="304511">Le type tileindex</h6><p id="r-304510" data-claire-element-id="304510">schema est un tableau vers des types "tileindex" que j'ai défini plus haut.<br> Dans notre cas, j'ai défini tileindex à "unsigned char", car je n'aurai pas plus de 256 tiles.<br> Si vous en avez davantage, changez juste le typedef en "unsigned short". <br> Si les "unsigned short" ne suffisent pas, on pourrait mettre "unsigned long", mais en réalité, plus de 65536 tiles dans la même map, c'est une folie...</p><h5 id="r-la-structure-tileprop" data-claire-element-id="304525">La structure TileProp</h5><p id="r-304513" data-claire-element-id="304513">La structure TileProp contient pour l'instant deux choses :</p><ul id="r-304518" data-claire-element-id="304518"><li id="r-304515" data-claire-element-id="304515"><p id="r-304514" data-claire-element-id="304514">un rectangle R ;</p></li><li id="r-304517" data-claire-element-id="304517"><p id="r-304516" data-claire-element-id="304516">la propriété plein/vide.</p></li></ul><p id="r-304519" data-claire-element-id="304519">Pourquoi stockons nous un SDL_Rect ? <br> Dans l'exemple du fichier précédent, vous avez pu constater dans la fonction Affichage que pour tous les tiles à afficher, je calculais un rectangle source sur le tileset, à chaque fois.<br> Comme on a beaucoup de tiles identiques, on recalculait plein de fois les mêmes.</p><p id="r-304520" data-claire-element-id="304520">Je propose de les calculer une fois pour toutes, et de les stocker. Ainsi, pour les futurs blits, on a déjà le rectangle source, il ne reste plus qu'à poser le tile à la bonne destination.</p><p id="r-304521" data-claire-element-id="304521">Schématiquement, on peut voir le lien ici entre le tableau de propriétés, et le tileset. Je n'ai rempli que la case 1, mais on aura la même chose avec toutes les autres cases.</p><figure id="r-304523" data-claire-element-id="304524"><img id="r-304522" data-claire-element-id="304522" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_397001_398000_397876.png" alt="Image utilisateur"></figure>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
<span class="arrow"></span>
<span class="next">Structure d'un fichier texte pour un niveau</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
<span class="next">Code exemple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Codeexemple"></a><h2>Code exemple</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
<span class="arrow"></span>
<span class="next">Structure dans le programme</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">
<span class="next">Scrolling</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-code-exemple-1" data-claire-element-id="304556">Code exemple</h4><p id="r-304527" data-claire-element-id="304527">Voyons maintenant une illustration de tout cela.<br> Ouvrez le projet "prog2".</p><p id="r-304528" data-claire-element-id="304528">Compilez le, lancez le. Vous devriez avoir le même résultat que le programme précédent... mais avec un code plus complexe !</p><div id="r-304530" data-claire-element-id="304530" data-claire-semantic="question"><p id="r-304529" data-claire-element-id="304529">Pourquoi faire compliqué quand on peut faire simple ?</p></div><p id="r-304531" data-claire-element-id="304531">Parce que le code précédent était inexploitable. <br> On peut envisager la métaphore suivante :<br> Si vous voulez construire une maison, la méthode la plus rapide est de poser tous les murs brutalement, puis le toit.<br> Par contre, si on vous dit "maintenant, ou on fait passer les tuyaux d'eau ? Les cables ?", et bien vous n'avez plus qu'à démolir.<br> Alors que si vous avez construit votre maison en prévoyant les goulottes, vous pourrez rajouter l'électricité par la suite, même si avant ça, les maisons avec et sans avoir prévu les goulottes se ressemblent.</p><p id="r-304532" data-claire-element-id="304532">Etudions le programme.</p><p id="r-304533" data-claire-element-id="304533">Regardons d'abord le fmap.h</p><pre id="r-304534" data-claire-element-id="304534"><code data-claire-semantic="c">#include &lt;sdl/sdl.h&gt;

#pragma comment (lib,"sdl.lib")      // ignorez ces lignes si vous ne linkez pas les libs de cette façon.
#pragma comment (lib,"sdlmain.lib")

typedef unsigned char tileindex;

typedef struct
{
	SDL_Rect R;
	int plein;
	// tout ce que vous voulez...
} TileProp;

typedef struct
{
	int LARGEUR_TILE,HAUTEUR_TILE;
	int nbtilesX,nbtilesY;
	SDL_Surface* tileset;
	TileProp* props;
	tileindex** schema;
	int nbtiles_largeur_monde,nbtiles_hauteur_monde;
} Map;

Map* ChargerMap(const char* fic);
int AfficherMap(Map* m,SDL_Surface* screen);
int LibererMap(Map* m);</code></pre><p id="r-304535" data-claire-element-id="304535">On retrouve les structures étudiées plus haut, ainsi que 3 fonctions seulement :</p><ul id="r-304542" data-claire-element-id="304542"><li id="r-304537" data-claire-element-id="304537"><p id="r-304536" data-claire-element-id="304536">ChargerMap ;</p></li><li id="r-304539" data-claire-element-id="304539"><p id="r-304538" data-claire-element-id="304538">AfficherMap ;</p></li><li id="r-304541" data-claire-element-id="304541"><p id="r-304540" data-claire-element-id="304540">LibererMap.</p></li></ul><p id="r-304543" data-claire-element-id="304543">Si vous n'êtes pas curieux, ce sont des fonctions magiques.<br> A la première, vous passez le fichier level.txt, et elle vous remplit une Map qu'elle vous donne.<br> A la seconde, vous donnez la map, et l'écran "screen" ou vous voulez l'afficher, et elle l'affiche.<br> A la troisième, vous donnez la map, elle nettoie proprement.</p><p id="r-304544" data-claire-element-id="304544">Maintenant, regardons le main, dans prog2.c</p><pre id="r-304545" data-claire-element-id="304545"><code data-claire-semantic="c">#include "fmap.h"


int main(int argc,char** argv)
{
	SDL_Surface* screen;
	SDL_Event event;
	Map* m;
	SDL_Init(SDL_INIT_VIDEO);		// prepare SDL
	screen = SDL_SetVideoMode(360, 208, 32,SDL_HWSURFACE|SDL_DOUBLEBUF);
	m = ChargerMap("level.txt");
	AfficherMap(m,screen);
	SDL_Flip(screen);
	do 
	{
		SDL_WaitEvent(&amp;event);
	} while (event.type!=SDL_KEYDOWN);
	LibererMap(m);
	SDL_Quit();
	return 0;
}</code></pre><p id="r-304546" data-claire-element-id="304546">Regardez la simplicité d'utilisation : je charge la map, je l'affiche, j'attends qu'on appuie sur une touche, et je la libère avant de la quitter.</p><p id="r-304547" data-claire-element-id="304547">Si vous n'êtes pas curieux donc, voila comment faire simple.</p><p id="r-304548" data-claire-element-id="304548">Pour les curieux, regardons fmap.c</p><pre id="r-304549" data-claire-element-id="304549"><code data-claire-semantic="c">#define _CRT_SECURE_NO_DEPRECATE   // pour visual C++ qui met des warning pour fopen et fscanf : aucun effet negatif pour les autres compilos.
#include &lt;string.h&gt;
#include "fmap.h"

#define CACHE_SIZE 5000

SDL_Surface* LoadImage32(const char* fichier_image)
{
	SDL_Surface* image_result;
	SDL_Surface* image_ram = SDL_LoadBMP(fichier_image);	// charge l'image dans image_ram en RAM
	if (image_ram==NULL)
	{
		printf("Image %s introuvable !! \n",fichier_image);
		SDL_Quit();
		system("pause");
		exit(-1);
	}
	image_result = SDL_DisplayFormat(image_ram);
	SDL_FreeSurface(image_ram);
	return image_result;
}

void ChargerMap_tileset(FILE* F,Map* m)
{
	int numtile,i,j;
	char buf[CACHE_SIZE];  // un buffer, petite mémoire cache
	char buf2[CACHE_SIZE];  // un buffer, petite mémoire cache
	fscanf(F,"%s",buf); // nom du fichier
	m-&gt;tileset = LoadImage32(buf);
	fscanf(F,"%d %d",&amp;m-&gt;nbtilesX,&amp;m-&gt;nbtilesY);
	m-&gt;LARGEUR_TILE = m-&gt;tileset-&gt;w/m-&gt;nbtilesX;
	m-&gt;HAUTEUR_TILE = m-&gt;tileset-&gt;h/m-&gt;nbtilesY;
	m-&gt;props = malloc(m-&gt;nbtilesX*m-&gt;nbtilesY*sizeof(TileProp));
	for(j=0,numtile=0;j&lt;m-&gt;nbtilesY;j++)
	{
		for(i=0;i&lt;m-&gt;nbtilesX;i++,numtile++)
		{
			m-&gt;props[numtile].R.w = m-&gt;LARGEUR_TILE;
			m-&gt;props[numtile].R.h = m-&gt;HAUTEUR_TILE;
			m-&gt;props[numtile].R.x = i*m-&gt;LARGEUR_TILE;
			m-&gt;props[numtile].R.y = j*m-&gt;HAUTEUR_TILE;
			fscanf(F,"%s %s",buf,buf2);
			m-&gt;props[numtile].plein = 0;
			if (strcmp(buf2,"plein")==0)
				m-&gt;props[numtile].plein = 1;
		}
	}
}

void ErrorQuit(const char* error)
{
	puts(error);
	SDL_Quit();
	system("pause");
	exit(-1);
}

void ChargerMap_level(FILE* F,Map* m)
{
	int i,j;
	fscanf(F,"%d %d",&amp;m-&gt;nbtiles_largeur_monde,&amp;m-&gt;nbtiles_hauteur_monde);
	m-&gt;schema = malloc(m-&gt;nbtiles_largeur_monde*sizeof(tileindex*));
	for(i=0;i&lt;m-&gt;nbtiles_largeur_monde;i++)
		m-&gt;schema[i] = malloc(m-&gt;nbtiles_hauteur_monde*sizeof(tileindex));
	for(j=0;j&lt;m-&gt;nbtiles_hauteur_monde;j++)
	{
		for(i=0;i&lt;m-&gt;nbtiles_largeur_monde;i++)
		{
			int tmp;
			fscanf(F,"%d",&amp;tmp);
			if (tmp&gt;=m-&gt;nbtilesX*m-&gt;nbtilesY)
				ErrorQuit("level tile hors limite\n");
			m-&gt;schema[i][j] = tmp;
		}
	}
}

Map* ChargerMap(const char* level)
{
	FILE* F;
	Map* m;
	char buf[CACHE_SIZE];
	F = fopen(level,"r");
	if (!F)
		ErrorQuit("fichier level introuvale\n");
	fgets(buf,CACHE_SIZE,F);
	if (strstr(buf,"Tilemapping Version 1.0")==NULL)
		ErrorQuit("Mauvaise version du fichier level. Ce programme attend la version 1.0\n");
	m = malloc(sizeof(Map));
	do 
	{
		fgets(buf,CACHE_SIZE,F);
		if (strstr(buf,"#tileset"))
			ChargerMap_tileset(F,m);
		if (strstr(buf,"#level"))
			ChargerMap_level(F,m);
	} while (strstr(buf,"#fin")==NULL);
	fclose(F);
	return m;
}

int AfficherMap(Map* m,SDL_Surface* screen)
{
	int i,j;
	SDL_Rect Rect_dest;
	int numero_tile;
	for(i=0;i&lt;m-&gt;nbtiles_largeur_monde;i++)
	{
		for(j=0;j&lt;m-&gt;nbtiles_hauteur_monde;j++)
		{
			Rect_dest.x = i*m-&gt;LARGEUR_TILE;
			Rect_dest.y = j*m-&gt;HAUTEUR_TILE;
			numero_tile = m-&gt;schema[i][j];
			SDL_BlitSurface(m-&gt;tileset,&amp;(m-&gt;props[numero_tile].R),screen,&amp;Rect_dest);
		}
	}
	return 0;
}

int LibererMap(Map* m)
{
	int i;
	SDL_FreeSurface(m-&gt;tileset);
	for(i=0;i&lt;m-&gt;nbtiles_hauteur_monde;i++)
		free(m-&gt;schema[i]);
	free(m-&gt;schema);
	free(m-&gt;props);
	free(m);
	return 0;
}</code></pre><p id="r-304550" data-claire-element-id="304550">Ce fichier n'est pas très complexe si vous savez lire un fichier texte.<br> Car la fonction ChargerMap ne fait finalement que des fscanf et des fgets.</p><p id="r-304551" data-claire-element-id="304551">Notons la fonction LoadImage32 qui va charger l'image, et la mettre au format de votre écran grâce à SDL_DisplayFormat, pour une vitesse de blit optimale.</p><p id="r-304552" data-claire-element-id="304552">La fonction ChargerMap_tileset va remplir le tableau, et le rectangle R pour chaque type de tile.</p><p id="r-304553" data-claire-element-id="304553">La fonction AfficherMap en est donc simplifiée, puisqu'elle va directement lire le rectangle source, et non le calculer à chaque fois.</p><p id="r-304554" data-claire-element-id="304554">A la fin de ce chapitre, vous voyez qu'on peut enfermer la difficulté dans un fichier (fmap.c) et le niveau dans un fichier texte (level.txt). <br> Finalement, le pilotage de l'ensemble, dans le main, reste très simple.</p><p id="r-304555" data-claire-element-id="304555">Amusez vous à modifier le fichier level.txt (par exemple en changeant les chiffres du tableau de schéma pour voir les modifications appliquées en relançant le programme, même sans le recompiler.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
<span class="arrow"></span>
<span class="next">Structure dans le programme</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">
<span class="next">Scrolling</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Scrolling"></a><h2>Scrolling</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
<span class="arrow"></span>
<span class="next">Code exemple</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
<span class="next">L'idée de l'image géante</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div class="content">
<p id="r-304558" data-claire-element-id="304558">Jusqu'à maintenant, on affichait une pauvre image fixe. Nous allons voir ici comment avoir un scrolling, c'est-à-dire un défilement d'écran.<br> Quand dans mario, vous courez, vous voyez le paysage qui défile derrière vous. C'est ce qu'on appelle le scrolling.</p>
</div><a name="L039idedel039imagegante"></a><h2>L'idée de l'image géante</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">
<span class="arrow"></span>
<span class="next">Scrolling</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
<span class="next">Le fenêtrage</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-l-idee-de-l-image-geante" data-claire-element-id="304568">L'idée de l'image géante</h4><p id="r-304559" data-claire-element-id="304559">Dans ce paragraphe, nous allons parler de l'idée de l'image géante. C'est une idée à laquelle on pense quand on veut faire du scrolling...</p><p id="r-304560" data-claire-element-id="304560">Imaginons un monde de mario qui fait 300 tiles de large (le monde entier, du départ jusqu'au drapeau). Chaque tile fait 24 pixels de large.</p><p id="r-304561" data-claire-element-id="304561">Si nous voulons dessiner tout le monde d'un coup, nous avons donc besoin d'une image de 300*24 = 7200 pixels de large. Une image géante donc !</p><p id="r-304562" data-claire-element-id="304562">L'idée est de blitter l'image géante où il faut, pour que seule la partie "intéressante" apparaisse. Et de la blitter légèrement plus loin à la frame d'après pour qu'on ait l'impression qu'on a bougé.</p><p id="r-304563" data-claire-element-id="304563">Mais cette image géante, en mémoire, prendra plusieurs dizaines de Mo. Et encore, si le monde est grand comme une carte de Zelda, ce sera en centaines de Mo que ça se comptera...</p><p id="r-304564" data-claire-element-id="304564">Sur un PC puissant, cette technique pourra marcher, même si elle risque de saturer la mémoire graphique (VRAM) mais c'est épouvantablement lourd.</p><div id="r-304566" data-claire-element-id="304566" data-claire-semantic="question"><p id="r-304565" data-claire-element-id="304565">Alors pourquoi les consoles comme la NES, très peu puissantes, arrivaient à gérer des scrollings alors qu'elles n'avaient que quelques Ko de mémoire ?</p></div><p id="r-304567" data-claire-element-id="304567">Tout simplement parce que stocker une image géante n'est pas une bonne idée...</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">
<span class="arrow"></span>
<span class="next">Scrolling</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
<span class="next">Le fenêtrage</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Lefentrage"></a><h2>Le fenêtrage</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
<span class="arrow"></span>
<span class="next">L'idée de l'image géante</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
<span class="next">Code exemple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-le-fenetrage" data-claire-element-id="304622">Le fenêtrage</h4><p id="r-304569" data-claire-element-id="304569">Bien que trop lourde en mémoire, nous n'allons pas oublier notre image géante. <br> Nous allons pour l'instant juste imaginer qu'elle existe, mais ne pas la stocker en mémoire.</p><p id="r-304570" data-claire-element-id="304570">Voici une belle image :</p><p id="r-304571" data-claire-element-id="304572"><a href="http://sdz.tdct.org/sdz/medias/uploads.siteduzero.com_files_190001_191000_190176.png"><img id="r-304572" data-claire-element-id="304571" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_thb_190001_191000_190176.png" alt="Image utilisateur"></a></p><p id="r-304573" data-claire-element-id="304573">Elle venait d'un exemple précédent que j'ai mis à jour. Dans l'exemple de la fin de ce chapitre, nous en aurons une autre plus jolie.</p><div id="r-304575" data-claire-element-id="304575" data-claire-semantic="question"><p id="r-304574" data-claire-element-id="304574">Qu'est ce que le rectangle rouge en bas à gauche ?</p></div><p id="r-304576" data-claire-element-id="304576">C'est un rectangle que j'ai rajouté pour l'exemple. Ce rectangle, je vais l'appeler fenêtre.</p><p id="r-304577" data-claire-element-id="304577">Cette fenêtre, c'est ce que vous verrez sur votre écran. Cette fenêtre se décalera et vous verrez donc autre chose. Si cette fenêtre glisse vers la droite, alors on aura l'impression d'avancer dans le monde.</p><p id="r-304578" data-claire-element-id="304578">Vous voyez le concept ? Seule la partie affichée dans la fenêtre sera affichée sur votre écran.</p><p id="r-304579" data-claire-element-id="304579">J'appellerai ce rectangle la <strong>fenêtre du scrolling</strong> et il suffira de déplacer cette fenêtre pour faire défiler le niveau.</p><p id="r-304580" data-claire-element-id="304580">Je vous propose un petit travail manuel pour bien vous en rendre compte. Prenez une feuille A4, et découpez, en plein milieu, un rectangle de la taille du rectangle rouge. Posez la feuille sur votre écran sur l'image géante ci dessus. Puis déplacez la. Vous voyez le monde défiler dans le trou que vous avez fait.</p><h5 id="r-deux-reperes" data-claire-element-id="304599">Deux repères</h5><p id="r-304581" data-claire-element-id="304581">Notre monde entier est l'image géante, que nous n'afficherons jamais entièrement, mais qui existe.<br> Dans ce monde, les coordonnées varient de 0 à .... beaucoup. 10 000 peut être, bien plus encore, si notre monde est grand.<br> Nous appellerons ça le repère absolu, ou repère global.</p><p id="r-304582" data-claire-element-id="304582">Par contre, la partie que nous voyons à l'écran, elle, a toujours la même largeur et hauteur (notre écran) avec ses coordonnés qui vont de 0 à 800 par exemple, jamais plus. <br> Nous appellerons ça le repère local.</p><p id="r-304583" data-claire-element-id="304583">Pour passer de l'un à l'autre, c'est très simple : nous allons définir le point S, de coordonnées xscroll/yscroll pour la fenêtre. C'est le point du coin supérieur gauche de la fenêtre dans le repère global.</p><p id="r-304584" data-claire-element-id="304584">Si on a un point dans le repère local, et qu'on veut sa coordonnée dans le repère global, on fait une addition.<br> Pour passer de global à local, on fait une soustraction.<br>P_{global} = P_{local} + SP_{local} = P_{global} - S</p><aside id="r-304586" data-claire-element-id="304586" data-claire-semantic="warning"><p id="r-304585" data-claire-element-id="304585">Le simple fait de modifier le point S permettra le scrolling.</p></aside><p id="r-304587" data-claire-element-id="304587">Voici comment nous allons modifier notre structure Map :</p><pre id="r-304588" data-claire-element-id="304588"><code data-claire-semantic="c">typedef struct
{
	SDL_Rect R;
	char plein;
} TileProp;

typedef struct
{
	int LARGEUR_TILE,HAUTEUR_TILE;
	int nbtiles;
	TileProp* props;
	SDL_Surface* tileset;
	tileindex** schema;
	int nbtiles_largeur_monde,nbtiles_hauteur_monde;
	int xscroll,yscroll;
	int largeur_fenetre,hauteur_fenetre;
} Map;</code></pre><p id="r-304589" data-claire-element-id="304589">Vous pouvez constater, par rapport aux structures de l'exemple d'avant, que seuls 4 paramètres ont été ajoutés : le reste n'a pas bougé.</p><pre id="r-304590" data-claire-element-id="304590"><code data-claire-semantic="c">int xscroll,yscroll;
int largeur_fenetre,hauteur_fenetre;</code></pre><p id="r-304591" data-claire-element-id="304591">Alors ces paramètre sont très simples : <br> largeur_fenetreet, hauteur_fenetre sont la largeur et hauteur de ma fenêtre de scrolling (la largeur et hauteur du rectangle rouge), et xscroll et yscroll sont la position de son point supérieur gauche, le point S.<br> Exactement comme un SDL_rect !</p><div id="r-304593" data-claire-element-id="304593" data-claire-semantic="question"><p id="r-304592" data-claire-element-id="304592">Mais pourquoi ne pas utiliser un SDL_Rect ?</p></div><p id="r-304594" data-claire-element-id="304594">Parce qu'un SDL_Rect utilise un x,y en tant que <em>signed short</em>, c'est-à-dire qu'il est limité à 32767 pixels.</p><p id="r-304595" data-claire-element-id="304595">Or, si notre monde est très très grand, l'image géante imaginée sera possiblement plus grande que cela. Nous utiliserons donc un int qui pourra nous permettre d'aller beaucoup plus loin.</p><p id="r-304596" data-claire-element-id="304596">largeur_fenetre et hauteur_fenetre resteront invariants : tout au long du jeu, la taille de la fenêtre d'affichage (ce que vous voyez) restera constante.<br> Par contre, xscroll et yscroll, eux, changeront.<br> Et quand il changeront la fenêtre rouge sur l'image géante se déplacera. Concrètement, il y aura scrolling...</p><aside id="r-304598" data-claire-element-id="304598" data-claire-semantic="information"><p id="r-304597" data-claire-element-id="304597">L'idée est donc maintenant de modifier la fonction d'affichage pour qu'elle affiche la partie du monde correspondant a la fenêtre rouge.</p></aside><h5 id="r-premiere-version" data-claire-element-id="304605">première version</h5><pre id="r-304600" data-claire-element-id="304600"><code data-claire-semantic="c">int AfficherMap(Map* m,SDL_Surface* screen)
{
	int i,j;
	SDL_Rect Rect_dest;
	int numero_tile;
	for(i=0;i&lt;m-&gt;nbtiles_largeur_monde;i++)
	{
		for(j=0;j&lt;m-&gt;nbtiles_hauteur_monde;j++)
		{
			Rect_dest.x = i*m-&gt;LARGEUR_TILE - m-&gt;xscroll;
			Rect_dest.y = j*m-&gt;HAUTEUR_TILE - m-&gt;yscroll;
			numero_tile = m-&gt;schema[i][j];
			SDL_BlitSurface(m-&gt;tileset,&amp;(m-&gt;props[numero_tile].R),screen,&amp;Rect_dest);
		}
	}
	return 0;
}</code></pre><p id="r-304601" data-claire-element-id="304601">Vous pouvez constater que la seule différence avec la fonction AfficherMap d'avant, c'est que Rdest.x et Rdest.y sont otés de m-&gt;xscroll et m-&gt;yscroll</p><p id="r-304602" data-claire-element-id="304602">Concrètement, avec cette fonction, je vais afficher TOUTE la grande map (car mes for vont de 0 à nbtiles_largeur_monde et de 0 à nbtiles_hauteur_monde, donc couvrent tout), mais en "décalant" de xscroll et yscroll.<br> Concrètement, si mon rectangle rouge est à l'endroit ci dessus, je vais quand même tout afficher (90% sera hors de l'écran mais tant pis) y compris le "FRED" qu'on voit en haut : il sera affiché hors écran (donc ignoré) mais on le calculera quand même...</p><p id="r-304603" data-claire-element-id="304603">Cette simple soustraction permet le scrolling. En effet, si xscroll évolue positivement, alors, pour chaque tile, Rect_dest.x évoluera négativement : ce qui est normal, car quand le rectangle rouge avance, on a l'impression que les tiles reculent ! Et oui, c'est magique !<br> Si vous regardez Mario, quand vous courrez dans un monde, les tiles, eux, vont en arrière...</p><p id="r-304604" data-claire-element-id="304604">L'exemple qui finira cette partie vous illustrera cela.</p><h5 id="r-deuxieme-version" data-claire-element-id="304616">Deuxième version</h5><p id="r-304606" data-claire-element-id="304606">L'inconvénient de la première version est qu'elle va essayer de blitter tous les tiles du niveau. Quand ils seront dehors, ils ne seront pas affichés, mais la machine essayera des les blitter quand même.<br> Du coup, plus le monde sera grand, plus les for seront longs, et plus la machine tentera de blitter, et plus ça va ralentir...<br> C'est dommage.</p><p id="r-304607" data-claire-element-id="304607">Je propose donc une optimisation.</p><p id="r-304608" data-claire-element-id="304608">Voici l'idée : seuls les tiles présents dans le cadre rouge devront être affichés. Les autres seront dehors : inutile de les afficher.<br> Nous allons donc, au lieu de faire varier notre for entre 0 et m-&gt;nbtiles_largeur_monde, le faire varier entre un xmin et un xmax. Pareil pour y.<br> Ainsi, nous restreignons notre boucle à la seule zone d'affichage.</p><p id="r-304609" data-claire-element-id="304609">Il faut donc calculer ces xmin, xmax, ymin et ymax</p><p id="r-304610" data-claire-element-id="304610">Quel est le xmin ? C'est la coordonnée de gauche de la fenêtre que divise la taille d'un tile tout simplement.<br> Et quel est le max ? La coordonnée de droite de la fenêtre que divise la taille d'un tile ...</p><p id="r-304611" data-claire-element-id="304611">Cela nous donne immédiatement notre deuxième version de la fonction AfficherMap :</p><pre id="r-304612" data-claire-element-id="304612"><code data-claire-semantic="c">int AfficherMap(Map* m,SDL_Surface* screen)
{
	int i,j;
	SDL_Rect Rect_dest;
	int numero_tile;
	int minx,maxx,miny,maxy;
	minx = m-&gt;xscroll / m-&gt;LARGEUR_TILE-1;
	miny = m-&gt;yscroll / m-&gt;HAUTEUR_TILE-1;
	maxx = (m-&gt;xscroll + m-&gt;largeur_fenetre)/m-&gt;LARGEUR_TILE;
	maxy = (m-&gt;yscroll + m-&gt;hauteur_fenetre)/m-&gt;HAUTEUR_TILE;
	for(i=minx;i&lt;=maxx;i++)
	{
		for(j=miny;j&lt;=maxy;j++)
		{
			Rect_dest.x = i*m-&gt;LARGEUR_TILE - m-&gt;xscroll;
			Rect_dest.y = j*m-&gt;HAUTEUR_TILE - m-&gt;yscroll;
			numero_tile = m-&gt;schema[i][j];
			SDL_BlitSurface(m-&gt;tileset,&amp;(m-&gt;props[numero_tile].R),screen,&amp;Rect_dest);
		}
	}
	return 0;
}</code></pre><p id="r-304613" data-claire-element-id="304613">je calcule mon xmin, xmax, ymin, ymax, puis je ne fais varier mes for que dans ces zones-là.<br> Pour xmin et ymin, je mets -1 car si le fenêtrage est entre deux tiles, il faut que le tile d'avant soit affiché, pour voir le morceau de droite (ou du bas) arriver par la gauche (ou par le haut).</p><aside id="r-304615" data-claire-element-id="304615" data-claire-semantic="information"><p id="r-304614" data-claire-element-id="304614">La taille de la map finale ne ralentira plus rien : en effet, la map peut être grand ou petite, il n'y aura pas plus de calculs.</p></aside><h5 id="r-troisieme-version" data-claire-element-id="304621">Troisième version</h5><p id="r-304617" data-claire-element-id="304617">Avec la deuxième version, la fonction plantera si la fenêtre de scrolling sort de l'espace de l'image géante, car les i,j déborderont du tableau m-&gt;schema.</p><p id="r-304618" data-claire-element-id="304618">Donc soit on fait attention à limiter le scrolling, <br> soit on protège la fonction avec un if, soit les deux.</p><p id="r-304619" data-claire-element-id="304619">Dans le cas de cette version, si on sort du schéma, on dit que on a des tiles de type 0, à l'infini...</p><pre id="r-304620" data-claire-element-id="304620"><code data-claire-semantic="c">int AfficherMap(Map* m,SDL_Surface* screen)
{
	int i,j;
	SDL_Rect Rect_dest;
	int numero_tile;
	int minx,maxx,miny,maxy;
	minx = m-&gt;xscroll / m-&gt;LARGEUR_TILE-1;
	miny = m-&gt;yscroll / m-&gt;HAUTEUR_TILE-1;
	maxx = (m-&gt;xscroll + m-&gt;largeur_fenetre)/m-&gt;LARGEUR_TILE;
	maxy = (m-&gt;yscroll + m-&gt;hauteur_fenetre)/m-&gt;HAUTEUR_TILE;
	for(i=minx;i&lt;=maxx;i++)
	{
		for(j=miny;j&lt;=maxy;j++)
		{
			Rect_dest.x = i*m-&gt;LARGEUR_TILE - m-&gt;xscroll;
			Rect_dest.y = j*m-&gt;HAUTEUR_TILE - m-&gt;yscroll;
			if (i&lt;0 || i&gt;=m-&gt;nbtiles_largeur_monde || j&lt;0 || j&gt;=m-&gt;nbtiles_hauteur_monde)
				numero_tile = 0;
			else
				numero_tile = m-&gt;schema[i][j];
			SDL_BlitSurface(m-&gt;tileset,&amp;(m-&gt;props[numero_tile].R),screen,&amp;Rect_dest);
		}
	}
	return 0;
}</code></pre>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
<span class="arrow"></span>
<span class="next">L'idée de l'image géante</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
<span class="next">Code exemple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Codeexemple"></a><h2>Code exemple</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
<span class="arrow"></span>
<span class="next">Le fenêtrage</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">
<span class="next">Un Editeur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-code-exemple-2" data-claire-element-id="304640">Code exemple</h4><p id="r-304623" data-claire-element-id="304623">Voici maintenant le code.<br> Ouvrez le projet "prog3", compilez le et lancez le.</p><p id="r-304624" data-claire-element-id="304624">Appuyez sur les flèches pour faire défiler le paysage !</p><p id="r-304625" data-claire-element-id="304625">Expliquons un peu le code.</p><p id="r-304626" data-claire-element-id="304626">fevent.h</p><pre id="r-304627" data-claire-element-id="304627"><code data-claire-semantic="c">#include &lt;sdl/sdl.h&gt;

typedef struct
{
	char key[SDLK_LAST];
	int mousex,mousey;
	int mousexrel,mouseyrel;
	char mousebuttons[8];
	char quit;
} Input;

void UpdateEvents(Input* in);
void InitEvents(Input* in);</code></pre><p id="r-304628" data-claire-element-id="304628">C'est ma façon de gérer les events, je mets à jour ma structure Input. J'explique tout cela <a href="http://www.siteduzero.com/tutoriel-3-145225-simplifier-les-events-avec-sdl.html">dans un autre tutoriel</a>. fevent.c va avec.</p><p id="r-304629" data-claire-element-id="304629">Concentrons nous maintenant sur le main, dans prog3.c</p><pre id="r-304630" data-claire-element-id="304630"><code data-claire-semantic="c">#include "fmap.h"
#include "fevent.h"

#define LARGEUR_FENETRE 500
#define HAUTEUR_FENETRE 500
#define MOVESPEED 1

void MoveMap(Map* m,Input* in)
{
	if (in-&gt;key[SDLK_LEFT])
		m-&gt;xscroll-=MOVESPEED;
	if (in-&gt;key[SDLK_RIGHT])
		m-&gt;xscroll+=MOVESPEED;
	if (in-&gt;key[SDLK_UP])
		m-&gt;yscroll-=MOVESPEED;
	if (in-&gt;key[SDLK_DOWN])
		m-&gt;yscroll+=MOVESPEED;
// limitation
	if (m-&gt;xscroll&lt;0)
		m-&gt;xscroll=0;
	if (m-&gt;yscroll&lt;0)
		m-&gt;yscroll=0;
	if (m-&gt;xscroll&gt;m-&gt;nbtiles_largeur_monde*m-&gt;LARGEUR_TILE-m-&gt;largeur_fenetre-1)
		m-&gt;xscroll=m-&gt;nbtiles_largeur_monde*m-&gt;LARGEUR_TILE-m-&gt;largeur_fenetre-1;
	if (m-&gt;yscroll&gt;m-&gt;nbtiles_hauteur_monde*m-&gt;HAUTEUR_TILE-m-&gt;hauteur_fenetre-1)
		m-&gt;yscroll=m-&gt;nbtiles_hauteur_monde*m-&gt;HAUTEUR_TILE-m-&gt;hauteur_fenetre-1;
}

int main(int argc,char** argv)
{
	SDL_Surface* screen;
	Map* m;
	Input I;
	InitEvents(&amp;I);
	SDL_Init(SDL_INIT_VIDEO);		// prepare SDL
	screen = SDL_SetVideoMode(LARGEUR_FENETRE, HAUTEUR_FENETRE, 32,SDL_HWSURFACE|SDL_DOUBLEBUF);
	m = ChargerMap("level2.txt",LARGEUR_FENETRE,HAUTEUR_FENETRE);
	while(!I.key[SDLK_ESCAPE] &amp;&amp; !I.quit)
	{
		UpdateEvents(&amp;I);
		MoveMap(m,&amp;I);
		AfficherMap(m,screen);
		SDL_Flip(screen);
		SDL_Delay(1);
	}
	LibererMap(m);
	SDL_Quit();
	return 0;
}</code></pre><p id="r-304631" data-claire-element-id="304631">Dans le main, j'initialise ChargerMap en précisant en paramètres supplémentaires la taille de la fenêtre que je désire.<br> Si vous voulez une fenêtre plus grande, changez simplement les #define en haut de ce fichier.</p><p id="r-304632" data-claire-element-id="304632">Dans le while du main, j'appelle une fonction MoveMap qui est au dessus. C'est elle qui va me permettre de commander mon scrolling.<br> Puis j'affiche la map, je flip et je fais un Delay pour réguler la vitesse.</p><p id="r-304633" data-claire-element-id="304633">La fonction MoveMap est très simple :<br> Je regarde les touches de direction, et en fonction d'elles, je mets simplement à jour les variables xscroll et yscroll. La fonction AfficherMap en tiendra compte.</p><p id="r-304634" data-claire-element-id="304634">Notez la partie "limitation", qui empêche la fenêtre de sortir du repère global. Si vous l'enlevez, alors vous pourrez sortir sans soucis.<br> Et dans la mesure ou la fonction AfficherMap considère que tout ce qui est dehors est le tile 0, alors si vous sortez, vous verrez des "tile 0" à perte de vue. Essayez donc !</p><p id="r-304635" data-claire-element-id="304635">Ici, mon tile 0 est un bloc qui se voit bien. Mais on pourrait mettre du ciel, ou donner un autre numéro de tile par défaut...</p><p id="r-304636" data-claire-element-id="304636">En ce qui concerne le fichier fmap.c, tout ce qui diffère avec la version précédente, c'est la fonction AfficherMap expliquée juste au dessus. <br> Il y a juste, à la fin de la fonction ChargerMap, le stockage des variables passées, et une initialisation de xscroll et yscroll à 0.</p><p id="r-304637" data-claire-element-id="304637">Ce qu'il faut bien retenir dans le scrolling, c'est que nous "imaginons" une grande image, faite du monde entier, qui peut être très grand ; et nous n'affichons que la partie désirée.<br> Nous ne stockons pas l'image géante complète en mémoire, mais nous stockons uniquement de quoi en calculer rapidement une partie (celle qui sera visible).</p><p id="r-304638" data-claire-element-id="304638">Pour faire défiler l'écran, il <strong>suffit</strong> de changer la valeur des variables xscroll et yscroll. L'affichage affiche ce qu'il faut en conséquence.</p><p id="r-304639" data-claire-element-id="304639">Ainsi, un scrolling horizontal et vertical revient uniquement à mettre à jour 2 variables...</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
<span class="arrow"></span>
<span class="next">Le fenêtrage</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">
<span class="next">Un Editeur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="UnEditeur"></a><h2>Un Editeur</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
<span class="arrow"></span>
<span class="next">Code exemple</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
<span class="next">Utilisation de l'éditeur</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div class="content">
<p id="r-304642" data-claire-element-id="304642">Si vous regardez le fichier level2.txt du projet prog3 avec un bloc note, vous pourrez constater qu'il y a beaucoup de nombre écrits, et que quelque part, ce n'est pas humain d'écrire tout ça à la main. Et vous avez raison !<br> On dit qu'il faut toujours se créer ses propres outils. Voici un éditeur qui permet de créer des fichiers de niveaux.</p>
</div><a name="Utilisationdel039diteur"></a><h2>Utilisation de l'éditeur</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">
<span class="arrow"></span>
<span class="next">Un Editeur</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">
<span class="next">Simple personnage</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-utilisation-de-l-editeur" data-claire-element-id="304677">Utilisation de l'éditeur</h4><p id="r-304643" data-claire-element-id="304643">L'éditeur se trouve dans le répertoire "Edit1".</p><p id="r-304644" data-claire-element-id="304644">Vous trouverez les sources que vous pourrez compiler pour l'utiliser.</p><h5 id="r-lancement-de-l-editeur" data-claire-element-id="304657">Lancement de l'éditeur</h5><p id="r-304645" data-claire-element-id="304645">L'éditeur ne démarre pas sans paramètres. Vous devez lui passer :</p><ul id="r-304650" data-claire-element-id="304650"><li id="r-304647" data-claire-element-id="304647"><p id="r-304646" data-claire-element-id="304646">soit un fichier .bmp (un tileset) pour faire une nouvelle carte ;</p></li><li id="r-304649" data-claire-element-id="304649"><p id="r-304648" data-claire-element-id="304648">soit un fichier .txt (un level déjà fait) pour en recharger une et la modifier.</p></li></ul><p id="r-304651" data-claire-element-id="304651">Vous pouvez lancer l'éditeur en ligne de commande avec un tel paramètre, ou bien faire glisser un bmp ou un txt sur l'EXE sous Windows : ça revient au même.</p><p id="r-304652" data-claire-element-id="304652">Dans le répertoire edit1, il y a des fichiers bmp ou des fichiers txt en exemple pour essayer.</p><h6 id="r-nouvelle-carte" data-claire-element-id="304654">Nouvelle carte.</h6><p id="r-304653" data-claire-element-id="304653">Si vous lancez une nouvelle carte, l'éditeur va vous demander combien il y a de tiles en x et en y sur votre tileset (à vous de compter). De la il calculera automatiquement leur largeur et hauteur.<br> Puis vous vous retrouverez dans l'éditeur proprement dit.</p><h6 id="r-ancienne-carte" data-claire-element-id="304656">Ancienne carte.</h6><p id="r-304655" data-claire-element-id="304655">Il chargera simplement une ancienne carte.<br> Puis vous vous retrouverez dans l'éditeur proprement dit.</p><h5 id="r-la-zone-d-edition" data-claire-element-id="304676">La zone d'édition</h5><p id="r-304658" data-claire-element-id="304658">L'éditeur se compose en 2 parties. La partie "choix du tile" qui affiche le tileset, et la partie "level" qui affiche le niveau en cours.<br> Au départ, c'est la partie "level qui s'affiche"</p><p id="r-304659" data-claire-element-id="304659">Pour passert d'une partie à une autre, cliquez sur le bouton droit de la souris à tout moment.</p><h6 id="r-partie-choix-du-tile" data-claire-element-id="304668">Partie "choix du tile"</h6><figure id="r-304661" data-claire-element-id="304662"><img id="r-304660" data-claire-element-id="304660" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_397001_398000_397916.png" alt="Image utilisateur"></figure><p id="r-304663" data-claire-element-id="304663">Dans cette partie, vous avez le tileset devant les yeux, vous voyez tous les tiles.<br> Cliquez sur un tile pour le sélectionner, vous reviendrez automatiquement à la partie "level"<br> Si vous maintenez la touche CTRL de gauche, vous passez en mode "mur". Vous pouvez alors sélectionner, pour chaque tile, s'il est un mur ou non.</p><figure id="r-304665" data-claire-element-id="304666"><img id="r-304664" data-claire-element-id="304664" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_397001_398000_397917.png" alt="Image utilisateur"></figure><p id="r-304667" data-claire-element-id="304667">Tout mur apparaîtra en violet mauve.</p><h6 id="r-partie-level" data-claire-element-id="304675">Partie "level"</h6><figure id="r-304670" data-claire-element-id="304671"><img id="r-304669" data-claire-element-id="304669" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_397001_398000_397915.png" alt="Image utilisateur"></figure><p id="r-304672" data-claire-element-id="304672">Utilisez la souris pour peindre le level avec le tile sélectionné par la partie "choix du tile", alternez entre les deux parties pour changer de tile.<br> Utilisez la molette pour agrandir ou rétrécir le monde. Utilisez les touches H et V pour sélectionner un agrandissement horizontal ou vertical.<br> Utilisez les flèches pour faire défiler la carte si vous avez agrandit le monde plus que la taille de la fenêtre par défaut.<br> Utilisez CTRL+S pour sauvegarder le travail. Si vous avez démarré avec un .bmp, le même nom de fichier sera créé avec comme extension .txt.</p><p id="r-304673" data-claire-element-id="304673">Ce petit éditeur vous épargnera le fait de remplir vos niveaux à la main.</p><p id="r-304674" data-claire-element-id="304674">Nous savons maintenant comment mettre en place une carte avec possibilité de scrolling. Par la suite, nous allons voir comment mettre un personnage sur cette carte, et le faire évoluer.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">
<span class="arrow"></span>
<span class="next">Un Editeur</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">
<span class="next">Simple personnage</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Simplepersonnage"></a><h2>Simple personnage</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
<span class="arrow"></span>
<span class="next">Utilisation de l'éditeur</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
<span class="next">Qu'est-ce qu'un personnage ?</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div class="content">
<p id="r-304681" data-claire-element-id="304681">Nous allons voir comment est défini un personnage, comment simplifier sa gestion, et voir comment l'insérer dans un monde simple.</p>
</div><a name="Qu039est-cequ039unpersonnage"></a><h2>Qu'est-ce qu'un personnage ?</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">
<span class="arrow"></span>
<span class="next">Simple personnage</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
<span class="next">Première approche de collision avec le décor</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-qu-est-ce-qu-un-personnage" data-claire-element-id="304705">Qu'est-ce qu'un personnage ?</h4><p id="r-304682" data-claire-element-id="304682">Avant de se lancer dans du code, essayons de définir ce qu'est un personnage dans un petit jeu de plateforme, ou un jeu vu de dessus.</p><p id="r-304683" data-claire-element-id="304683">Il est important de définir quelques notions avant d'aller plus loin. Dans un jeu comme Mario Bros, Mario est dans le monde, et il <strong>bouge</strong>.</p><p id="r-304684" data-claire-element-id="304684">Ce mot <strong>bouge</strong> n'est pas précis. En réalité, le personnage bouge de deux manières indépendantes : l'animation, et le déplacement.</p><h5 id="r-l-animation-1" data-claire-element-id="304694">L'animation</h5><p id="r-304685" data-claire-element-id="304685">Pour bien comprendre ce qu'on appellera l'animation, prenons n'importe quel GIF animé du net, sans couleur transparente derrière :</p><figure id="r-304687" data-claire-element-id="304688"><img id="r-304686" data-claire-element-id="304686" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_210001_211000_210678.gif" alt="Image utilisateur"></figure><p id="r-304689" data-claire-element-id="304689">Un très joli petit Mario animé...</p><div id="r-304691" data-claire-element-id="304691" data-claire-semantic="question"><p id="r-304690" data-claire-element-id="304690">Que remarque-t-on ?</p></div><p id="r-304692" data-claire-element-id="304692">Nous remarquons que le Mario "bouge" à l'intérieur d'un carré vert (qui est sa boîte englobante), qui, elle, <strong>reste fixe</strong>.<br> J'ai désactivé la transparence du gif pour bien voir cette boîte verte.</p><p id="r-304693" data-claire-element-id="304693">Ce qui se passe à l'intérieur de cette boîte verte est <strong>l'animation</strong>.<br> Ce sont les pieds de Mario qui bougent, c'est un joli dessin qui s'anime...</p><h5 id="r-le-deplacement-2" data-claire-element-id="304704">Le déplacement</h5><p id="r-304695" data-claire-element-id="304695">Dans un jeu, l'animation ne suffit pas, il faut qu'on puisse déplacer notre personnage. Concrètement, il faut faire bouger notre boîte verte, la faire avancer dans le monde, tout simplement.</p><aside id="r-304697" data-claire-element-id="304697" data-claire-semantic="information"><p id="r-304696" data-claire-element-id="304696">Il est important de faire la différence entre déplacement et animation !</p></aside><p id="r-304698" data-claire-element-id="304698">Tous les personnages des jeux dont nous parlons sont animés, et se déplacent.<br> Mario en fait partie.</p><ul id="r-304703" data-claire-element-id="304703"><li id="r-304700" data-claire-element-id="304700"><p id="r-304699" data-claire-element-id="304699">Parfois, l'animation est réduite à une seule image, donc il n'y a finalement pas d'animation. C'est le cas d'un nuage qui se déplace, d'un missile qui se déplace. Cela est de plus en plus rare, car on animera le missile (en le faisant tourner, en animant le réacteur...) pendant son déplacement pour un meilleur esthétisme. Qui a dit qu'un missile ne pouvait pas être esthétique ? :-°</p></li><li id="r-304702" data-claire-element-id="304702"><p id="r-304701" data-claire-element-id="304701">Parfois, le sprite ne bouge pas, mais s'anime : c'est le cas de tous les gifs animés du net par exemple. C'est le cas d'un Ryu qui danse en garde avant le <em>FIGHT !</em></p></li></ul>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">
<span class="arrow"></span>
<span class="next">Simple personnage</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
<span class="next">Première approche de collision avec le décor</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Premireapprochedecollisionavecledcor"></a><h2>Première approche de collision avec le décor</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
<span class="arrow"></span>
<span class="next">Qu'est-ce qu'un personnage ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
<span class="next">Algorithme de déplacement</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-premiere-approche-de-collision-avec-le-decor" data-claire-element-id="304767">Première approche de collision avec le décor</h4><p id="r-304706" data-claire-element-id="304706">Nous allons maintenant parler collisions.</p><p id="r-304707" data-claire-element-id="304707">Notre but va être le suivant : Mario va se déplacer dans un monde avec des murs.</p><aside id="r-304709" data-claire-element-id="304709" data-claire-semantic="error"><p id="r-304708" data-claire-element-id="304708">Il ne faut pas que Mario passe à travers les murs...</p></aside><p id="r-304710" data-claire-element-id="304710">Reprenons notre petit Mario animé :</p><figure id="r-304712" data-claire-element-id="304713"><img id="r-304711" data-claire-element-id="304711" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_210001_211000_210678.gif" alt="Image utilisateur"></figure><div id="r-304715" data-claire-element-id="304715" data-claire-semantic="question"><p id="r-304714" data-claire-element-id="304714">Comment savoir s'il touche un mur ?</p></div><p id="r-304716" data-claire-element-id="304716">Voici deux solutions.</p><h5 id="r-le-pixel-perfect" data-claire-element-id="304735">Le pixel perfect</h5><p id="r-304717" data-claire-element-id="304717">Le pixel perfect est un algorithme de collision perfectionniste qui va dire :</p><aside id="r-304719" data-claire-element-id="304719" data-claire-semantic="warning"><p id="r-304718" data-claire-element-id="304718">Si un seul pixel de Mario touche un mur, alors il y a collision.</p></aside><p id="r-304720" data-claire-element-id="304720">Nous oublions donc notre boite englobante verte pour cet algorithme :</p><figure id="r-304722" data-claire-element-id="304723"><img id="r-304721" data-claire-element-id="304721" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_210001_211000_210986.gif" alt="Image utilisateur"></figure><p id="r-304724" data-claire-element-id="304724">Il va falloir déterminer, pour chaque pixel, s'il touche ou non un mur.<br> Sachant que notre Mario est animé, il se peut qu'à une frame d'animation, il ne touche pas le mur, et qu'à une autre, il le touche. <br> Que faisons nous alors ? On peut le faire reculer... Du coup, s'il continue d'être animé, et qu'on le fait déplacer vers le mur, on le verra trembler, car à chaque frame de l'animation, il sera déplacé. Disons le tout de suite, ça sera moche.</p><ul id="r-304731" data-claire-element-id="304731"><li id="r-304726" data-claire-element-id="304726"><p id="r-304725" data-claire-element-id="304725">Ce sera moche !</p></li><li id="r-304728" data-claire-element-id="304728"><p id="r-304727" data-claire-element-id="304727">Ce sera calculatoire, car il faudra déterminer s'il y a collision pour chaque pixel. Notre Mario est petit, mais s'il était plus grand, le nombre de calculs exploserait...</p></li><li id="r-304730" data-claire-element-id="304730"><p id="r-304729" data-claire-element-id="304729">On aura des problèmes de collisions qui dépendront de la frame d'animation en cours.</p></li></ul><p id="r-304732" data-claire-element-id="304732">Ce sont quelques problèmes que peut soulever le <em>pixel perfect</em>.</p><p id="r-304733" data-claire-element-id="304733">Il pourrait en poser encore bien d'autres : dans un jeu du genre Zelda, si le pixel perfect était appliqué, on pourrait coincer notre bouclier entre deux branches d'arbre du décor. Pour s'en sortir, ce ne serait pas simple.<br> Il y a d'autres problèmes qui pourraient arriver. Le pixel perfect est - selon moi - un nid à problèmes. Évidemment, cela n'engage que moi. Il peut être utile dans certains cas, mais sûrement pas dans notre cas à nous.</p><p id="r-304734" data-claire-element-id="304734">Nous allons donc oublier cet algorithme pour notre sujet, il n'est pas adapté.</p><h5 id="r-collision-par-boite-englobante-aabb" data-claire-element-id="304766">Collision par boite englobante (AABB)</h5><p id="r-304736" data-claire-element-id="304736">Une <em>Axes Aligned Bounding Box</em> (AABB) est le nom qu'on donne à la boite englobante verte de Mario :</p><figure id="r-304738" data-claire-element-id="304739"><img id="r-304737" data-claire-element-id="304737" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_210001_211000_210678.gif" alt="Image utilisateur"></figure><p id="r-304740" data-claire-element-id="304740">On la définit par son origine (le point en haut à gauche), sa largeur et sa hauteur (d'ailleurs, SDL_Rect est typiquement fait pour ça).<br> Elle est alignée avec les axes du monde : pas de losanges, mais un beau rectangle "droit".</p><p id="r-304741" data-claire-element-id="304741">On partira du principe que si la boite englobante touche un mur, alors Mario touche. Et ceci indépendamment de la frame d'animation de ce dernier. Si la boite touche, ça touche, et si elle ne touche pas, alors Mario ne touche pas.</p><p id="r-304742" data-claire-element-id="304742">Observez bien cette boîte englobante, elle est suffisamment serrée autour de Mario pour que cette gestion des collisions soit suffisante.</p><p id="r-304743" data-claire-element-id="304743">L'algorithme de collision avec le décor que nous allons voir rapidement ici ne considèrera <strong>que</strong> la boite englobante.</p><aside id="r-304745" data-claire-element-id="304745" data-claire-semantic="information"><p id="r-304744" data-claire-element-id="304744">On oublie donc l'animation de Mario, on ne parle plus que de la boîte !</p></aside><p id="r-304746" data-claire-element-id="304746">Voici donc notre boîte verte :</p><figure id="r-304748" data-claire-element-id="304749"><img id="r-304747" data-claire-element-id="304747" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_210001_211000_210992.gif" alt="Image utilisateur"></figure><h6 id="r-precaution" data-claire-element-id="304753">Précaution</h6><p id="r-304750" data-claire-element-id="304750">Pour utiliser cet algo, et donc faire abstraction des frames d'animation pour les collisions, il y a une précaution à prendre au niveau de l'animation.</p><p id="r-304751" data-claire-element-id="304751">L'animation est définie par un ensemble de petits dessins qu'on blit à la coordonnée (x,y) voulue, on en colle une à l'autre en fonction du temps passé. C'est ça qui fait l'animation.<br> Il est <strong>fondamental</strong> que ces petits dessins fassent tous la même taille (la même hauteur, la même largeur) : ainsi, la taille de la boîte englobante reste invariante d'une frame à l'autre.<br> C'est le cas de notre petit Mario. Vous pouvez constater sur le petit gif animé que si Mario bouge, la boîte verte, elle, reste fixe.</p><p id="r-304752" data-claire-element-id="304752">Sans cette contrainte, la boîte englobante se déformerait lors de l'animation, et, selon la frame, le rectangle, sans se déplacer, pourrait être dans le mur pour une frame, hors du mur pour une autre. <br> En garantissant les images de la même taille pour chaque frame, ce problème n'existe plus : soit le personnage est dans un mur, soit il ne l'est pas, et cela pour toutes ses animations.</p><h6 id="r-principe-dans-un-monde" data-claire-element-id="304765">Principe dans un monde</h6><p id="r-304754" data-claire-element-id="304754">Notre boîte verte se déplace dans un monde, il faut simplement empêcher qu'elle rentre dans un mur.<br> Le principe est simple.</p><p id="r-304755" data-claire-element-id="304755">Nous définissons une fonction fondamentale, qu'on appellera <strong>CollisionDecor</strong>.<br> Cette fonction prend la boîte verte (sa position, sa largeur, sa hauteur), et nous dit simplement :</p><ul id="r-304760" data-claire-element-id="304760"><li id="r-304757" data-claire-element-id="304757"><p id="r-304756" data-claire-element-id="304756">tu es dans un mur ;</p></li><li id="r-304759" data-claire-element-id="304759"><p id="r-304758" data-claire-element-id="304758">tu n'es pas dans un mur.</p></li></ul><p id="r-304761" data-claire-element-id="304761">Informatiquement parlant, elle renvoie 1 si on touche un mur, 0 sinon.</p><aside id="r-304763" data-claire-element-id="304763" data-claire-semantic="information"><p id="r-304762" data-claire-element-id="304762">Cette fonction clé va faire le pont entre le personnage et le décor.</p></aside><p id="r-304764" data-claire-element-id="304764">Tel un aveugle qui se ballade dans la rue, on veut juste savoir, à tout moment, si on touche un mur ou non. A partir de cette seule fonction, on va mettre en place nos collisions.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
<span class="arrow"></span>
<span class="next">Qu'est-ce qu'un personnage ?</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
<span class="next">Algorithme de déplacement</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Algorithmededplacement"></a><h2>Algorithme de déplacement</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
<span class="arrow"></span>
<span class="next">Première approche de collision avec le décor</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
<span class="next">Code exemple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-algorithme-de-deplacement" data-claire-element-id="304816">Algorithme de déplacement</h4><p id="r-304768" data-claire-element-id="304768">Nous souhaitons déplacer notre boîte verte dans le décor.<br> Dans cette partie, nous allons voir comment faire, en faisant intervenir notre fonction <strong>CollisionDecor</strong>.<br> Voici le schéma suivant :</p><figure id="r-304770" data-claire-element-id="304771"><img id="r-304769" data-claire-element-id="304769" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_211001_212000_211004.png" alt="Image utilisateur"></figure><p id="r-304772" data-claire-element-id="304772">Au départ, nous avons notre boîte verte claire, qui est hors mur. En effet, il est interdit d'être dans un mur. La position initiale doit donc être hors mur.</p><p id="r-304773" data-claire-element-id="304773">Nous allons déplacer notre boîte verte selon un vecteur de déplacement (qui est rouge sur l'image ci dessus). Le but est que le modèle se déplace, mais qu'à sa position finale, il soit toujours hors mur.</p><p id="r-304774" data-claire-element-id="304774">Voici une première version de l'algorithme.</p><ul id="r-304787" data-claire-element-id="304787"><li id="r-304776" data-claire-element-id="304776"><p id="r-304775" data-claire-element-id="304775">La boîte verte claire est a une position initiale hors mur, nous donnons le vecteur de déplacement souhaité.</p></li><li id="r-304778" data-claire-element-id="304778"><p id="r-304777" data-claire-element-id="304777">Nous calculons l'éventuelle position finale (verte foncée).</p></li><li id="r-304780" data-claire-element-id="304780"><p id="r-304779" data-claire-element-id="304779">Nous demandons à CollisionDecor si la boîte verte foncée est dans le mur ou non.</p></li><li id="r-304782" data-claire-element-id="304782"><p id="r-304781" data-claire-element-id="304781">Si elle ne l'est pas, on valide le déplacement : notre boîte verte claire prend la place de la boîte verte foncée (cas A).</p></li><li id="r-304784" data-claire-element-id="304784"><p id="r-304783" data-claire-element-id="304783">Sinon, nous ignorons le déplacement, on ne bouge pas notre boîte verte (cas B).</p></li><li id="r-304786" data-claire-element-id="304786"><p id="r-304785" data-claire-element-id="304785">Dans tous les cas, nous sommes toujours hors mur à ce moment là.</p></li></ul><p id="r-304788" data-claire-element-id="304788">Avec cet algorithme, le cas A et le cas B fonctionnent : on se déplace si on peut, on ne bouge pas si on ne peut pas.</p><h6 id="r-le-cas-c" data-claire-element-id="304815">Le cas C</h6><p id="r-304789" data-claire-element-id="304789">Le cas C est plus complexe. Notre rectangle vert clair ne touche pas le mur, mais n'est pas collé contre non plus. Si on souhaite le faire bouger selon le vecteur rouge, la nouvelle position calculée rentrera dans le mur (cas C(a)), ce n'est pas bon, donc ce n'est pas validé. L'algorithme ci-dessus ne fera donc pas bouger du tout le rectangle vert clair -&gt; nous nous retrouverons dans le cas B, sauf que nous ne sommes pas collés au mur.</p><aside id="r-304791" data-claire-element-id="304791" data-claire-semantic="information"><p id="r-304790" data-claire-element-id="304790">Notre rectangle ne touchera donc jamais le mur, il restera toujours à quelques pixels de celui-ci. C'est gênant.</p></aside><p id="r-304792" data-claire-element-id="304792">L'idée est que si le mouvement nous amène dans le mur, de voir si on ne pourrait pas modifier le vecteur rouge de façon à faire un plus petit mouvement pour s'en approcher au plus près. Le mieux étant d'aller le toucher, se coller à lui au pixel près, mais sans qu'il y ait collision. Nous aurons alors le cas C(b). J'appellerai cette opération <strong>Affiner le mouvement</strong>.</p><p id="r-304793" data-claire-element-id="304793">Voici donc une deuxième version de l'algorithme.</p><ul id="r-304813" data-claire-element-id="304813"><li id="r-304795" data-claire-element-id="304795"><p id="r-304794" data-claire-element-id="304794">La boîte verte claire est à une position initiale hors mur, nous donnons le vecteur de déplacement souhaité.</p></li><li id="r-304797" data-claire-element-id="304797"><p id="r-304796" data-claire-element-id="304796">Nous calculons l'éventuelle position finale (verte foncée).</p></li><li id="r-304799" data-claire-element-id="304799"><p id="r-304798" data-claire-element-id="304798">Nous demandons à CollisionDecor si la boîte verte foncée est dans le mur ou non.</p></li><li id="r-304801" data-claire-element-id="304801"><p id="r-304800" data-claire-element-id="304800">Si elle ne l'est pas, on valide le déplacement : notre boîte verte claire prend la place de la boîte verte foncée (cas A).</p></li><li id="r-304803" data-claire-element-id="304803"><p id="r-304802" data-claire-element-id="304802">Sinon, nous sommes dans le cas B ou le cas C.</p></li><ul id="r-304810" data-claire-element-id="304810"><li id="r-304805" data-claire-element-id="304805"><p id="r-304804" data-claire-element-id="304804">Nous cherchons un vecteur affiné, qui permettrait d'aller se coller contre le mur, en faisant des essais, et en retestant avec CollisionDecor.</p></li><li id="r-304807" data-claire-element-id="304807"><p id="r-304806" data-claire-element-id="304806">Si ce vecteur est nul (on est déjà collé sur le mur) alors on ne bouge pas (cas B).</p></li><li id="r-304809" data-claire-element-id="304809"><p id="r-304808" data-claire-element-id="304808">Sinon on se déplace de ce vecteur, et on se retrouve collé au mur (sans rentrer dedans bien sûr !) et on valide le déplacement (cas C(b)).</p></li></ul><li id="r-304812" data-claire-element-id="304812"><p id="r-304811" data-claire-element-id="304811">Dans tous les cas, nous sommes toujours hors mur à ce moment là.</p></li></ul><p id="r-304814" data-claire-element-id="304814">Nous proposerons plus loin des méthodes pour affiner.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
<span class="arrow"></span>
<span class="next">Première approche de collision avec le décor</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
<span class="next">Code exemple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Codeexemple"></a><h2>Code exemple</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
<span class="arrow"></span>
<span class="next">Algorithme de déplacement</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">
<span class="next">Insertion dans un monde de Tiles</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-code-exemple-3" data-claire-element-id="304856">Code exemple</h4><p id="r-304817" data-claire-element-id="304817">Maintenant que nous avons vu le principe que nous allons mettre en place, voici un code qui va illustrer tout cela, dans un monde très très simple pour commencer !<br> Ce monde sera juste un rectangle marron...</p><p id="r-304818" data-claire-element-id="304818">Prenez le projet prog4, et compilez le, et lancez le.</p><aside id="r-304820" data-claire-element-id="304820" data-claire-semantic="information"><p id="r-304819" data-claire-element-id="304819">Utilisez les flèches pour déplacer le rectangle vert, echap pour quitter.</p></aside><aside id="r-304822" data-claire-element-id="304822" data-claire-semantic="information"><p id="r-304821" data-claire-element-id="304821">Vous constatez rapidement que quand on s'approche du rectangle marron, il y a quelques soucis. Lisez bien cette partie jusqu'au bout pour résoudre cela.</p></aside><p id="r-304823" data-claire-element-id="304823">Si on regarde le main, dans prog4.c :</p><pre id="r-304824" data-claire-element-id="304824"><code data-claire-semantic="c">#include "fevent.h"
#include "fsprite.h"

void RecupererVecteur(Input* in,int* vx,int* vy)
{
	int vitesse = 5;
	*vx = *vy = 0;
	if (in-&gt;key[SDLK_UP])
		*vy = -vitesse;
	if (in-&gt;key[SDLK_DOWN])
		*vy = vitesse;
	if (in-&gt;key[SDLK_LEFT])
		*vx = -vitesse;
	if (in-&gt;key[SDLK_RIGHT])
		*vx = vitesse;
}

void Evolue(Input* in,SDL_Rect* mur,Sprite* perso)
{
	int vx,vy;
	RecupererVecteur(in,&amp;vx,&amp;vy);
	DeplaceSprite(perso,mur,vx,vy);
}

int main(int argc,char** argv)
{
	SDL_Rect mur;
	Sprite* perso;
	SDL_Surface* screen;
	Input in;
	memset(&amp;in,0,sizeof(in));
	SDL_Init(SDL_INIT_VIDEO);		// prepare SDL
	screen = SDL_SetVideoMode(800,600,32,SDL_HWSURFACE|SDL_DOUBLEBUF);
	mur.x = 450;
	mur.y = 100;
	mur.w = 100;
	mur.h = 200;
	perso = InitialiserSprite(101,150,50,100);
	while(!in.key[SDLK_ESCAPE])
	{
		UpdateEvents(&amp;in);
		Evolue(&amp;in,&amp;mur,perso);
		SDL_FillRect(screen,NULL,0);  // nettoie l'ecran en noir
		SDL_FillRect(screen,&amp;mur,0x800000);  // affiche le mur
		AfficherSprite(perso,screen);
		SDL_Flip(screen);
		SDL_Delay(5);
	}
	LibereSprite(perso);
	SDL_Quit();
	return 0;
}</code></pre><p id="r-304825" data-claire-element-id="304825">On voit dans le main que je crée un SDL_Rect, que j'appelle mur. Ce sera mon décor. Je lui donne une position, et des dimensions. <br> Puis j'initialise un sprite, c'est à dire un objet mobile. Nous verrons plus loin par quoi est défini ici un sprite pour le moment.</p><p id="r-304826" data-claire-element-id="304826">dans la boucle, on "Evolue", puis on affiche le mur, et le sprite.</p><h6 id="r-evolue" data-claire-element-id="304828">Evolue</h6><p id="r-304827" data-claire-element-id="304827">La fonction Evolue, juste au dessus, fait 2 choses : d'abord, elle récupère un vecteur de déplacement via la fonction RecupererVecteur qui est au dessus, puis elle déplace le sprite selon ce vecteur.</p><h6 id="r-recuperervecteur" data-claire-element-id="304837">RecupererVecteur</h6><p id="r-304829" data-claire-element-id="304829">Cette fonction est très simple, elle lit les touches du clavier (les flèches) et met un vecteur à jour. 8 positions possibles (les 4 directions ainsi que les diagonales) ainsi que le vecteur nul possible.</p><p id="r-304830" data-claire-element-id="304830">Passons maintenant au fichier fsprite.h</p><pre id="r-304831" data-claire-element-id="304831"><code data-claire-semantic="c">#include &lt;sdl/sdl.h&gt;

#pragma comment (lib,"sdl.lib")      // ignorez ces lignes si vous ne linkez pas les libs de cette façon.
#pragma comment (lib,"sdlmain.lib")

typedef struct
{
	SDL_Rect position;
} Sprite;

Sprite* InitialiserSprite(Sint16 x,Sint16 y,Sint16 w,Sint16 h);
void LibereSprite(Sprite*);
int DeplaceSprite(Sprite* perso,SDL_Rect* mur,int vx,int vy);
void AfficherSprite(Sprite* perso,SDL_Surface* screen);</code></pre><p id="r-304832" data-claire-element-id="304832">Vous voyez qu'actuellement, un sprite, ce n'est qu'un SDL_Rect.<br> On peut l'initialiser, le libérer quand on a fini, puis le déplacer, et l'afficher.</p><p id="r-304833" data-claire-element-id="304833">Passons a fsprite.c</p><pre id="r-304834" data-claire-element-id="304834"><code data-claire-semantic="c">#include "fsprite.h"

#define SGN(X) (((X)==0)?(0):(((X)&lt;0)?(-1):(1)))
#define ABS(X) ((((X)&lt;0)?(-(X)):(X)))

Sprite* InitialiserSprite(Sint16 x,Sint16 y,Sint16 w,Sint16 h)
{
	Sprite* sp = malloc(sizeof(Sprite));
	sp-&gt;position.x = x;
	sp-&gt;position.y = y;
	sp-&gt;position.w = w;
	sp-&gt;position.h = h;
	return sp;
}
void LibereSprite(Sprite* sp)
{
	free(sp);
}

int CollisionDecor(SDL_Rect* m,SDL_Rect* n)
{
	if((m-&gt;x &gt;= n-&gt;x + n-&gt;w) 
		|| (m-&gt;x + m-&gt;w &lt;= n-&gt;x) 
		|| (m-&gt;y &gt;= n-&gt;y + n-&gt;h) 
		|| (m-&gt;y + m-&gt;h &lt;= n-&gt;y) 
		) 
		return 0; 
	return 1; 
}

int EssaiDeplacement(Sprite* perso,SDL_Rect* mur,int vx,int vy)
{
	SDL_Rect test;
	test = perso-&gt;position;
	test.x+=vx;
	test.y+=vy;
	if (CollisionDecor(mur,&amp;test)==0)
	{
		perso-&gt;position = test;
		return 1;
	}
	return 0;
}

void Affine(Sprite* perso,SDL_Rect* mur,int vx,int vy)
{
	int i;	
	for(i=0;i&lt;ABS(vx);i++)
	{
		if (EssaiDeplacement(perso,mur,SGN(vx),0)==0)
			break;
	}
	for(i=0;i&lt;ABS(vy);i++)
	{
		if (EssaiDeplacement(perso,mur,0,SGN(vy))==0)
			break;			
	}
}

int DeplaceSprite(Sprite* perso,SDL_Rect* mur,int vx,int vy)
{
	if (EssaiDeplacement(perso,mur,vx,vy)==1)
		return 1;
	/*Affine(mur,perso,vx,vy);*/
	return 2;
}

void AfficherSprite(Sprite* perso,SDL_Surface* screen)
{
	SDL_Rect copyperso;
	copyperso = perso-&gt;position;
	SDL_FillRect(screen,&amp;copyperso,0x00FF00);  // affiche le perso
}</code></pre><p id="r-304835" data-claire-element-id="304835">Regardons tout d'abord les fonctions les plus simples :<br> InitialiserSprite,LibereSprite ne devraient pas poser de soucis.</p><p id="r-304836" data-claire-element-id="304836">AfficherSprite contient une légère astuce : au lieu de passer directement le SDL_Rect du sprite à la fonction SDL_FillRect, je passe une copie. <br> Tout comme SDL_BlitSurface, si vous ne passez pas une copie, vous risquez d'avoir des problèmes si vous faites sortir votre sprite à gauche ou en haut de l'écran. Passer une copie permet de ne pas avoir ce problème.</p><h6 id="r-deplacesprite" data-claire-element-id="304840">DeplaceSprite</h6><p id="r-304838" data-claire-element-id="304838">Nous voila à la fonction la plus complexe de ce programme.</p><p id="r-304839" data-claire-element-id="304839">Tout d'abord, la fonction lance EssaiDeplacement. Si cet essai est bon, on sort de la fonction. Sinon, on ne fait rien car la suite est commentée.</p><h6 id="r-essaideplacement" data-claire-element-id="304842">EssaiDeplacement</h6><p id="r-304841" data-claire-element-id="304841">La fonction EssaiDeplacement va essayer de déplacer le sprite selon le vecteur donné. Je dis essayer, car elle prend le décor en paramètres (ici un simple mur), et si le déplacement nous amène dans un mur, elle ne déplace pas et renvoie 0, comme on a vu plus haut dans le cas B, ou le cas C(a).<br> Si elle arrive à nous déplacer (cas A), elle met à jour perso-&gt;position et retourne 1 pour dire qu'elle a réussi.</p><h6 id="r-collisiondecor" data-claire-element-id="304850">CollisionDecor</h6><p id="r-304843" data-claire-element-id="304843">La fonction CollisionDecor est l'algorithme de collision AABB <a href="http://www.siteduzero.com/tutoriel-3-254500-formes-simples.html#ss_part_2">que je détaille ici</a>.<br> Elle renvoie 1 si et seulement si les deux rectangles se chevauchent.</p><aside id="r-304845" data-claire-element-id="304845" data-claire-semantic="information"><p id="r-304844" data-claire-element-id="304844">Arrêtons de détailler le code ici pour le moment, et relançons le programme</p></aside><p id="r-304846" data-claire-element-id="304846">Allez vous coller contre le rectangle marron. Vous pouvez constater que si vous arrivez par la gauche, vous ne pouvez pas vous coller au pixel près.<br> Pire, lorsque vous êtes presque collé, si vous appuyez en même temps à droite et en haut, votre sprite ignore l'appui sur le haut, alors que vous pourriez monter.<br> Dans ce dernier cas, vous êtes dans le cas C(a) et il n'y a pas d'affinage.</p><p id="r-304847" data-claire-element-id="304847">Reprenons le code. Regardez la fonction DeplaceSprite.<br> Vous pouvez constater qu'une ligne est commentée :</p><pre id="r-304848" data-claire-element-id="304848"><code data-claire-semantic="c">/*Affine(mur,perso,vx,vy);*/</code></pre><p id="r-304849" data-claire-element-id="304849">Décommentez les et relancez le programme.<br> Oh miracle, vous pouvez maintenant aller vous coller au pixel près, et glisser sur le mur.</p><h6 id="r-la-fonction-affine" data-claire-element-id="304855">La fonction Affine</h6><p id="r-304851" data-claire-element-id="304851">La fonction affine va juste prendre le vecteur, et tenter de s'approcher pixel par pixel en X d'abord, puis en Y ensuite.<br> La macro ABS renvoie la valeur absolue de la valeur passée<br> la macro SGN renvoie 1 si la valeur est positive, -1 si elle est négative (0 si elle est nulle)</p><p id="r-304852" data-claire-element-id="304852">La fonction Affine va faire des essais pixel par pixel jusqu'à aller se coller contre.<br> C'est le cas C(b).</p><p id="r-304853" data-claire-element-id="304853">A la fin de cette première partie, nous avons fait les premiers pas vers la collision avec un décor. Ce décor-ci était très simple. Cependant, nous verrons que même si le décor est complexe, même s'il y a scrolling, et même si nous ne contrôlons pas directement le vecteur de déplacement lorsque c'est une fonction de gestion de physique qui le fait, le concept restera le même.</p><p id="r-304854" data-claire-element-id="304854">Nous allons progressivement parler de tout ça, en ajoutant, étape par étape, les nouveaux éléments.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
<span class="arrow"></span>
<span class="next">Algorithme de déplacement</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">
<span class="next">Insertion dans un monde de Tiles</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="InsertiondansunmondedeTiles"></a><h2>Insertion dans un monde de Tiles</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
<span class="arrow"></span>
<span class="next">Code exemple</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
<span class="next">La nouvelle fonction CollisionDecor</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div class="content">
<p id="r-304858" data-claire-element-id="304858">Nous avons vu dans la partie 1 comment créer un monde fait de tiles.<br> Nous avons vu au début de la partie 2 comment gérer un personnage simpliste et ses collisions avec un mur simple.<br> Voyons maintenant comment relier le tout !</p>
</div><a name="LanouvellefonctionCollisionDecor"></a><h2>La nouvelle fonction CollisionDecor</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">
<span class="arrow"></span>
<span class="next">Insertion dans un monde de Tiles</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
<span class="next">Les déplacements rapides</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-la-nouvelle-fonction-collisiondecor" data-claire-element-id="304920">La nouvelle fonction CollisionDecor</h4><p id="r-304859" data-claire-element-id="304859">Comme je vous le disais en conclusion de la sous-partie précédente, le concept de déplacement va rester le même : la fonction <em>DeplaceSprite</em> et ses sous-fonctions vont ressembler à celles d'avant, le majeur changement va être le changement de la fonction CollisionDecor, celle qui dit "tu es dans un mur ou pas".</p><p id="r-304860" data-claire-element-id="304860">Nous allons donc voir comment cette fonction peut marcher pour un monde fait de tiles.</p><p id="r-304861" data-claire-element-id="304861">Rappelons que nous raisonnons dans le "grand monde", qui, même s'il n'est pas affiché, est calculable. <br> C'est à dire que si je suis dans un grand monde, mon personnage peut très bien être à la position x = 10000, y = 8625 par exemple...</p><p id="r-304862" data-claire-element-id="304862">Dans le chapitre d'avant, cette fonction se ramenait à simplement tester une collision entre deux rectangles : le personnage et le mur.</p><p id="r-304863" data-claire-element-id="304863">Voyons pour tester les collisions dans un monde de tiles.</p><h5 id="r-la-solution-violente" data-claire-element-id="304867">La solution violente</h5><p id="r-304864" data-claire-element-id="304864">La première idée est de se dire que dans l'exemple d'avant, j'avais un mur, je testais avec un algorithme de collision boite/boite.<br> Ici, dans mon monde, j'ai davantage de murs, je teste avec chacun, et si on en touche un, on renvoie 1.</p><p id="r-304865" data-claire-element-id="304865">Le gros problème qu'on voit tout de suite est que, dans un monde de Mario, on est au début du stage, et on va tester tous les murs du stage, y compris les blocs de l'arrivée, qui sont loin ! Loin et nombreux !</p><p id="r-304866" data-claire-element-id="304866">C'est très calculatoire, beaucoup trop violent à infliger à sa machine, et à oublier rapidement.</p><h5 id="r-localiser-les-tiles-qui-pourraient-intervenir" data-claire-element-id="304907">Localiser les tiles qui pourraient intervenir</h5><p id="r-304868" data-claire-element-id="304868">L'idée première va être de localiser les tiles concernés. C'est-à-dire que si notre Mario est au début du stage, inutile de tester les tiles de la fin du stage : on ne va tester que ceux qu'il touche.</p><figure id="r-304870" data-claire-element-id="304871"><img id="r-304869" data-claire-element-id="304869" src="./Tutoriel _ Tile Mapping_files/grille-collisions.png" alt="Image utilisateur"></figure><p id="r-304872" data-claire-element-id="304872">Ci-dessus un petit dessin, nous voyons le monde complet, découpé en tiles (en gris), et plusieurs personnages schématisés par leur boîte englobante (notre fameuse boîte verte).<br> En clair derrière eux, les tiles que le perso touche.</p><aside id="r-304874" data-claire-element-id="304874" data-claire-semantic="information"><p id="r-304873" data-claire-element-id="304873">Tester ces tiles-la, et uniquement ceux-la, est suffisant.</p></aside><p id="r-304875" data-claire-element-id="304875">L'algorithme va être le suivant :</p><ul id="r-304882" data-claire-element-id="304882"><li id="r-304877" data-claire-element-id="304877"><p id="r-304876" data-claire-element-id="304876">Localiser les tiles concernés (les tiles colorés) en fonction du personnage.</p></li><li id="r-304879" data-claire-element-id="304879"><p id="r-304878" data-claire-element-id="304878">Tester chacun de ces tiles : si l'un d'entre eux est un mur, on renvoie 1 (collision).</p></li><li id="r-304881" data-claire-element-id="304881"><p id="r-304880" data-claire-element-id="304880">Sinon, on renvoie 0 (pas de collision).</p></li></ul><h6 id="r-localiser-les-tiles-concernes" data-claire-element-id="304893">Localiser les tiles concernés</h6><p id="r-304883" data-claire-element-id="304883">L'ensemble des tiles concernés formera un rectangle. Ce rectangle aura comme premier tile celui d'en haut à gauche, le tile de coordonnées (xmin,ymin), et comme dernier tile celui d'en bas à droite, le tile de coordonnées (xmax,ymax).</p><p id="r-304884" data-claire-element-id="304884">Déterminer ces quatre données sera très rapide : pour (xmin,ymin), il va falloir déterminer dans quel tile est le point en haut à gauche de notre rectangle de personnage. Pour déterminer (xmax,ymax), il va falloir déterminer dans quel tile est le point en bas à droite de notre rectangle de personnage.<br> Regardez de nouveau le dessin, la règle est respectée.</p><p id="r-304885" data-claire-element-id="304885">Déterminer dans quel tile est un point est extrêmement rapide : notre monde est régulier, et le premier tile commence à la coordonnée (0,0). <br> Pour un personnage ayant comme boîte x,y (point en haut à gauche personnage), et largeur w et hauteur h, on peut écrire :</p><p id="r-304886" data-claire-element-id="304886">xmin = x/LARGEURTILEymin = y/HAUTEURTILE</p><p id="r-304887" data-claire-element-id="304887">Le point en bas à droite du personnage est calculé à partir de ses coordonnées (x,y) auxquelles on ajoute respectivement w-1 et h-1.</p><p id="r-304888" data-claire-element-id="304888">x_{basdroite} = x + w - 1y_{basdroite} = y + h - 1</p><p id="r-304889" data-claire-element-id="304889">De ce fait, nous avons :</p><p id="r-304890" data-claire-element-id="304890">xmax = x_{basdroite}/LARGEUR_TILEymax = y_{basdroite}/HAUTEUR_TILE</p><aside id="r-304892" data-claire-element-id="304892" data-claire-semantic="information"><p id="r-304891" data-claire-element-id="304891">Le calcul de ces valeurs ne dépend absolument pas de la taille du monde : de ce fait, même si le monde est immense, le calcul ne sera pas plus long.</p></aside><h6 id="r-boucle-de-tests-a-faire" data-claire-element-id="304902">Boucle de tests à faire</h6><p id="r-304894" data-claire-element-id="304894">Une fois qu'on a déterminé le rectangle de tiles à tester, il faut tous les tester. Nous n'échapperons pas à un double for :</p><pre id="r-304895" data-claire-element-id="304895"><code data-claire-semantic="c">int i,j;
for(i=xmin;i&lt;=xmax;i++)
{
  for(j=ymin;j&lt;=ymax;j++)
  {
     // tester un tile, si on touche un mur, inutile d'aller plus loin : on retourne 1
  }
}</code></pre><p id="r-304896" data-claire-element-id="304896">La vitesse de cet algo dépend directement de la taille de votre personnage. Si votre personnage est petit, on testera 2, voir 4, voir 6 tiles (tout dépend du chevauchement de tiles de votre personnage). Ce n'est pas fixe, regardez le dessin ci-dessus, le rectangle violet et le rouge font à peu près la même taille, mais leur position n'est pas la même, et le rouge est à cheval sur davantage de tiles.</p><p id="r-304897" data-claire-element-id="304897">Le carré vert est un plus gros personnage (un gros monstre par exemple), on testera donc davantage de tiles pour lui.</p><aside id="r-304899" data-claire-element-id="304899" data-claire-semantic="information"><p id="r-304898" data-claire-element-id="304898">Notre algorithme de collision fonctionnera sur tout type de personnages, de taille quelconque.</p></aside><p id="r-304900" data-claire-element-id="304900">Même si ce double for dépend de la taille du personnage, il sera rapide, car à moins de faire des super-monstres-énormes, il y aura toujours peu de tiles à tester !</p><p id="r-304901" data-claire-element-id="304901">Pour les furieux de l'optimisation, on peut toujours aller plus loin : <br> Au lieu de tester tous les tiles entre xmin,ymin / xmax,ymax, on ne peut tester que ceux du bord du rectangle, et pas les tiles intérieurs. En effet, on peut partir du principe qu'un gros personnage est hors de tout mur, et qu'il ne pourra jamais avoir de mur à l'intérieur de lui, car les tests de collision avec les bords auront empêché ça. De ce fait, seuls les tiles du bord du rectangle de tiles concernés peuvent être testés. Sur le dessin ci-dessus, on pourrait ne pas tester les 3 tiles au milieu du rectangle de tiles vert.<br> Cette optimisation n'a de raison d'être que pour les très gros personnages, pas pour un Mario...<br> Souvent dans les jeux, les gros monstres sont d'ailleurs dans des zones ouvertes, et on ne teste pas leur collision avec le décor.</p><h6 id="r-tester-un-tile-version-lente" data-claire-element-id="304904">Tester un tile (version lente)</h6><p id="r-304903" data-claire-element-id="304903">Dans la boucle qu'on aura faite, il faut donc tester un tile. La version lente consiste à récupérer le tile à tester, à récupérer sa boîte englobante, et lancer un algo de collision boîte/boîte (vu au chapitre précédent) pour voir si on touche.<br> Même si c'est rapide, c'est un peu bête car le travail est pré-mâché pour aller bien plus vite.</p><h6 id="r-tester-un-tile-version-optimale" data-claire-element-id="304906">Tester un tile (version optimale)</h6><p id="r-304905" data-claire-element-id="304905">Nous testons un tile à la position i,j. Si nous le testons, c'est que le perso le chevauche. Il suffit juste de voir si ce tile est identifié comme un "mur" ou pas. C'est tout !</p><h5 id="r-la-fonction-complete" data-claire-element-id="304919">La fonction complète</h5><p id="r-304908" data-claire-element-id="304908">Voici donc la fonction complète qui résume tout ce que nous avons vu :</p><pre id="r-304909" data-claire-element-id="304909"><code data-claire-semantic="c">int CollisionDecor(Sprite* perso)
{
	int xmin,xmax,ymin,ymax,i,j,indicetile;
	Map* m = perso-&gt;m;
	if (perso-&gt;x&lt;0 || (perso-&gt;x + perso-&gt;w -1)&gt;=m-&gt;nbtiles_largeur_monde*m-&gt;LARGEUR_TILE 
	 || perso-&gt;y&lt;0 || (perso-&gt;y + perso-&gt;h -1)&gt;=m-&gt;nbtiles_hauteur_monde*m-&gt;HAUTEUR_TILE)
		return 1;
	xmin = perso-&gt;x / m-&gt;LARGEUR_TILE;
	ymin = perso-&gt;y / m-&gt;HAUTEUR_TILE;
	xmax = (perso-&gt;x + perso-&gt;w -1) / m-&gt;LARGEUR_TILE;
	ymax = (perso-&gt;y + perso-&gt;h -1) / m-&gt;HAUTEUR_TILE;
	for(i=xmin;i&lt;=xmax;i++)
	{
		for(j=ymin;j&lt;=ymax;j++)
		{
			indicetile = m-&gt;schema[i][j];
			if (m-&gt;props[indicetile].plein)
				return 1;
		}
	}
	return 0;
}</code></pre><p id="r-304910" data-claire-element-id="304910">On retrouve xmin,xmax,ymin,ymax calculés comme nous avons vu.<br> Il y a en dessous un petit test, qui regarde si le perso sort du monde. Nous partons du principe que le perso ne doit pas sortir du monde. Donc si une de nos quatre valeurs est hors du monde, en renvoie 1 -&gt; on touche. Concrètement, tout se passe comme si le monde était entouré par un mur. Vous verrez dans l'exemple ci dessous qu'on ne peut pas sortir.</p><aside id="r-304912" data-claire-element-id="304912" data-claire-semantic="information"><p id="r-304911" data-claire-element-id="304911">On pourrait changer ça, et dire que le bord du monde ne contient pas de mur. Dans ce cas, il suffirait de ramener les coordonnées xmin,ymin / xmax,ymax dans le monde. On ne testerait ainsi que les rectangles du monde.</p></aside><aside id="r-304914" data-claire-element-id="304914" data-claire-semantic="warning"><p id="r-304913" data-claire-element-id="304913">Quoi que vous choisissiez comme principe quand le perso sort du monde, il faut faire attention à ce que xmin,ymin / xmax,ymax soient des valeurs dans le monde. En effet, ces valeurs vont être utilisées pour tester le tableau carte-&gt;schema[][] de la structure Map. Il ne faut pas déborder, sous peine de plantage...</p></aside><p id="r-304915" data-claire-element-id="304915">On retrouve ensuite le double for. Dedans, pour chaque i,j concerné, on regarde l'indice du tile concerné, et on va voir dans le tableau props si ce tile a la propriété mur activée. Si c'est le cas, on renvoie qu'on touche, sans même avoir besoin de finir le for.</p><p id="r-304916" data-claire-element-id="304916">Si on sort du for, c'est qu'aucun tile mur n'a été touché, alors on renvoie 0 -&gt; on ne touche pas.</p><aside id="r-304918" data-claire-element-id="304918" data-claire-semantic="information"><p id="r-304917" data-claire-element-id="304917">Cette fonction est peu calculatoire, très rapide, et fiable. Tant mieux car c'est une fonction appelée souvent, il faut qu'elle soit rapide. C'est le cas !</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">
<span class="arrow"></span>
<span class="next">Insertion dans un monde de Tiles</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
<span class="next">Les déplacements rapides</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Lesdplacementsrapides"></a><h2>Les déplacements rapides</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
<span class="arrow"></span>
<span class="next">La nouvelle fonction CollisionDecor</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
<span class="next">Code exemple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-les-deplacements-rapides" data-claire-element-id="304945">Les déplacements rapides</h4><p id="r-304921" data-claire-element-id="304921">Avant de voir le code, et un beau petit exemple de collision dans notre petit monde, soulevons un petit problème.</p><p id="r-304922" data-claire-element-id="304922">Nous avons vu comment nous faisons nos déplacements : on applique un vecteur de translation, si la position finale est valide, on bouge, sinon, on affine ou on ne bouge pas.</p><p id="r-304923" data-claire-element-id="304923">Cela marche très bien, mais à une seule condition : qu'on ne bouge pas trop vite.</p><p id="r-304924" data-claire-element-id="304924">Imaginons un Sonic qui fonce. Son vecteur de déplacement devient grand, il <em>tabule</em>, c'est à dire qu'à une frame on le dessine à une position, à une autre, on le dessine beaucoup plus loin (en réalité, avec le scrolling, c'est la carte qui tabule, mais ça revient au même).</p><p id="r-304925" data-claire-element-id="304925">Voici le problème que ça peut poser :</p><figure id="r-304927" data-claire-element-id="304928"><img id="r-304926" data-claire-element-id="304926" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_211001_212000_211183.png" alt="Image utilisateur"></figure><p id="r-304929" data-claire-element-id="304929">A gauche, on voit notre boîte verte. On veut la déplacer selon le vecteur rouge. Or, il y a un mur. Mais le vecteur rouge est grand, donc l'algorithme qu'on a vu plus haut va tenter de le déplacer, va réussir, car la position test est hors mur. Et Sonic aura traversé le mur... C'est moche, non ?</p><p id="r-304930" data-claire-element-id="304930">Il y a danger que cela arrive si, pour un vecteur vx,vy, vx&gt;= LARGEUR_TILE ou vy&gt;=HAUTEUR_TILE.<br> Par contre, si cette condition n'est pas remplie, aucune chance d'avoir ce problème.</p><p id="r-304931" data-claire-element-id="304931">Il faut donc éviter ce cas :</p><ul id="r-304936" data-claire-element-id="304936"><li id="r-304933" data-claire-element-id="304933"><p id="r-304932" data-claire-element-id="304932">soit en empêchant de se déplacer trop vite ;</p></li><li id="r-304935" data-claire-element-id="304935"><p id="r-304934" data-claire-element-id="304934">soit en coupant le déplacement en plusieurs morceaux acceptables.</p></li></ul><p id="r-304937" data-claire-element-id="304937">Nous n'allons bien sûr pas vous empêcher d'aller vite. Nous allons voir comment faire pour couper le déplacement en deux.<br> Si vous regardez la partie droite du dessin, vous voyez qu'au lieu de translater d'un grand vecteur rouge, je translate deux fois d'un plus petit vecteur rouge. Et ce vecteur nous permettra de bien se payer le mur. <br> On va lancer deux fois la fonction Deplace, avec un vecteur réduit de moitié à chaque fois.<br> La première fois, on va aller cogner le mur, et l'affinage va nous plaquer contre.<br> La deuxième fois, à partir de la position collée contre le mur, on n'avancera pas.<br> Le problème disparait.</p><p id="r-304938" data-claire-element-id="304938">L'algorithme qu'on va mettre en place dans la fonction Deplace est simple et récursif :</p><pre id="r-304939" data-claire-element-id="304939"><code data-claire-semantic="c">int DeplaceSprite(Sprite* perso,int vx,int vy)
{
	if (vx&gt;=perso-&gt;m-&gt;LARGEUR_TILE || vy&gt;=perso-&gt;m-&gt;HAUTEUR_TILE)
	{
		DeplaceSprite(perso,vx/2,vy/2);
		DeplaceSprite(perso,vx-vx/2,vy-vy/2);
		return 3;
	}
	if (EssaiDeplacement(perso,vx,vy)==1)
		return 1;
	Affine(perso,vx,vy);
	return 2;
}</code></pre><p id="r-304940" data-claire-element-id="304940">Nous voyons que si vx ou vy sont trop grand, on relance deux fois la fonction avec un vecteur deux fois plus petit dans un premier temps, suivi du "reste", donc également un vecteur deux fois plus petit.</p><p id="r-304941" data-claire-element-id="304941">L'avantage de la récursivité, c'est que si les nouveaux vecteurs sont toujours trop grand, on redécoupe, quitte à relancer l'algo quatre fois, huit fois... Jusqu'à ce que le vecteur soit acceptable !</p><p id="r-304942" data-claire-element-id="304942">Si ce chapitre vous échappe (car vous n'aimez pas la récursivité ou ne comprenez pas tout) ignorez, mais faites attention à vos vitesses... Ou alors acceptez la fonction telle qu'elle est.</p><aside id="r-304944" data-claire-element-id="304944" data-claire-semantic="information"><p id="r-304943" data-claire-element-id="304943">Notez qu'avec des nombres entiers, vx-vx/2 n'est pas forcément égal à vx/2</p></aside>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
<span class="arrow"></span>
<span class="next">La nouvelle fonction CollisionDecor</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
<span class="next">Code exemple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Codeexemple"></a><h2>Code exemple</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
<span class="arrow"></span>
<span class="next">Les déplacements rapides</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">
<span class="next">Scrolling automatique</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-code-exemple-4" data-claire-element-id="304962">Code exemple</h4><p id="r-304946" data-claire-element-id="304946">Nous finirons ce chapitre par du code qui reprend ce que nous avons vu plus haut.</p><p id="r-304947" data-claire-element-id="304947">Prenez le programme "prog5".</p><p id="r-304948" data-claire-element-id="304948">Compilez le et lancez le. Utilisez les flèches pour déplacer le rectangle vert, et les touches "fgth" pour contrôler le scrolling.<br> Vous pouvez remarquer que vous ne pouvez pas rentrer dans les décors.<br> Sauf les barrières et fleurs, car elles sont renseignées comme "vide".</p><p id="r-304949" data-claire-element-id="304949">Vous ne pouvez pas sortir non plus du monde, car la fonction CollisionDecor renvoie qu'il y a collision si on sort.</p><p id="r-304950" data-claire-element-id="304950">Voyons un petit peu le code.<br> Beaucoup de choses réutilisées des anciens codes.</p><p id="r-304951" data-claire-element-id="304951">Ici, j'ai changé la structure Sprite dans fsprite.h</p><pre id="r-304952" data-claire-element-id="304952"><code data-claire-semantic="c">typedef struct
{
	Map* m;
	int x,y,w,h;
} Sprite;</code></pre><p id="r-304953" data-claire-element-id="304953">Les sprites embarquent maintenant un pointeur vers la map. Et les x,y,w,h ne sont plus dans SDL_Rect, parce que les x,y pourront devenir très grands. En effet, les coordonnées du sprite seront celles du repère global.<br> Cela pourra permettre au sprite de pouvoir sortir de la zone de scrolling, en continuant d'être actif.</p><p id="r-304954" data-claire-element-id="304954">L'intérêt de stocker les coordonnées globales, c'est que le scrolling le déplacera automatiquement, il n'y aura pas de mouvement à compenser par le scrolling.</p><h6 id="r-la-fonction-affichersprite" data-claire-element-id="304961">La fonction AfficherSprite</h6><pre id="r-304955" data-claire-element-id="304955"><code data-claire-semantic="c">void AfficherSprite(Sprite* perso,SDL_Surface* screen)
{
	SDL_Rect R;
	R.x = perso-&gt;x - perso-&gt;m-&gt;xscroll;
	R.y = perso-&gt;y - perso-&gt;m-&gt;yscroll;
	R.w = perso-&gt;w;
	R.h = perso-&gt;h;
	SDL_FillRect(screen,&amp;R,0x00FF00);  // affiche le perso
}</code></pre><p id="r-304956" data-claire-element-id="304956">Elle tient compte des paramètres de fenêtrage qu'elle va chercher via le lien qu'embarque chaque sprite.<br> Notez bien que s'il y a plusieurs sprite, ils auront tous un lien vers la même map. Il n'y a pas une map par sprite.</p><p id="r-304957" data-claire-element-id="304957">Tout le reste est de la réutilisation des chapitres précédents.</p><p id="r-304958" data-claire-element-id="304958">Nous avons enfin intégré notre personnage (même réduit à un simple rectangle) dans le monde des tiles.<br> Il ne passe plus à travers les murs.</p><p id="r-304959" data-claire-element-id="304959">Pour l'instant, il est vert et carré, et il vole. <br> Notez que les jeux vus de dessus (comme Zelda Link to the past, ou la philosophie RPG Maker), utilisent ce concept. Dans ces jeux, pas besoin de gravité.</p><p id="r-304960" data-claire-element-id="304960">Vous pouvez vous appuyer sur l'exemple en l'état pour faire un jeu vu de dessus, même s'il est préférable de continuer à lire pour voir les diverses techniques que je vais vous proposer ! ;)</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
<span class="arrow"></span>
<span class="next">Les déplacements rapides</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">
<span class="next">Scrolling automatique</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Scrollingautomatique"></a><h2>Scrolling automatique</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
<span class="arrow"></span>
<span class="next">Code exemple</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
<span class="next">Centre du monde !</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div class="content">
<p id="r-304964" data-claire-element-id="304964">L'exemple précédent proposait de se déplacer dans un monde, avec scrolling manuel : c'est-à-dire que c'était à vous de faire défiler l'écran avec des touches.<br> Tout joueur que vous êtes, vous savez que dans les jeux, ça ne se passe pas comme ça, que ce n'est pas vous qui faites manuellement défiler l'écran. L'ordi le fait pour vous.</p><p id="r-304965" data-claire-element-id="304965">Nous allons voir dans ce chapitre comment faire en sorte que l'ordi le fasse pour vous, qu'il suive automatiquement votre personnage pour un meilleur confort de jeu.</p><p id="r-304966" data-claire-element-id="304966">Je proposerai plusieurs méthodes.</p>
</div><a name="Centredumonde"></a><h2>Centre du monde !</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">
<span class="arrow"></span>
<span class="next">Scrolling automatique</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
<span class="next">Scrolling à sous-boîte limite</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-centre-du-monde" data-claire-element-id="304998">Centre du monde !</h4><p id="r-304967" data-claire-element-id="304967">Si vous aimez être le centre du monde, vous allez aimer cette méthode !</p><p id="r-304968" data-claire-element-id="304968">Avec cette méthode, nous souhaitons que le joueur soit toujours bien au milieu. <br> Nous allons donc ajuster le fenêtrage du scrolling pour faire en sorte que notre joueur soit au milieu. Nous déplaçons librement notre joueur, à l'ordi de nous suivre.</p><p id="r-304969" data-claire-element-id="304969">Si nous regardons le dessin ci-dessous :</p><figure id="r-304971" data-claire-element-id="304972"><img id="r-304970" data-claire-element-id="304970" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_211001_212000_211752.png" alt="Image utilisateur"></figure><p id="r-304973" data-claire-element-id="304973">Nous voyons le fenêtrage de scrolling en rouge. Nous voyons notre personnage bien centré au milieu du cadre rouge.<br> En haut à gauche, le point bleu, c'est les coordonnées de nos paramètres xscroll et yscroll. C'est eux qu'il faut mettre à jour en fonction de la position de notre personnage.</p><p id="r-304974" data-claire-element-id="304974">C'est un peu de géométrie !</p><h6 id="r-quelques-calculs" data-claire-element-id="304991">Quelques calculs</h6><p id="r-304975" data-claire-element-id="304975">J'ai :</p><ul id="r-304984" data-claire-element-id="304984"><li id="r-304977" data-claire-element-id="304977"><p id="r-304976" data-claire-element-id="304976">xscroll, yscroll : coordonnées du point haut gauche de la fenêtre de scrolling.</p></li><li id="r-304979" data-claire-element-id="304979"><p id="r-304978" data-claire-element-id="304978">largeur_fenetre, hauteur_fenetre : largeur et hauteur de cette fenêtre.</p></li><li id="r-304981" data-claire-element-id="304981"><p id="r-304980" data-claire-element-id="304980">perso-&gt;x et perso-&gt;y : point haut gauche de mon perso (du rectangle vert).</p></li><li id="r-304983" data-claire-element-id="304983"><p id="r-304982" data-claire-element-id="304982">perso-&gt;w et perso-&gt;h : largeur et hauteur du perso.</p></li></ul><p id="r-304985" data-claire-element-id="304985">On veut que le centre de la fenêtre corresponde au centre du perso.</p><p id="r-304986" data-claire-element-id="304986">Le centre du perso, c'est :<br>x = perso-&gt;x + perso-&gt;w/2y = perso-&gt;y + perso-&gt;h/2</p><p id="r-304987" data-claire-element-id="304987">Le centre de la fenêtre c'est :<br>x = xscroll + largeurfenetre/2y = yscroll + hauteurfenetre/2</p><p id="r-304988" data-claire-element-id="304988">On veut que ces centres coïncident, donc :<br>perso-&gt;x + perso-&gt;w/2 = xscroll + largeurfenetre/2perso-&gt;y + perso-&gt;h/2 = yscroll + hauteurfenetre/2</p><p id="r-304989" data-claire-element-id="304989">On cherche xscroll et yscroll, on résout, on trouve :<br>xscroll = perso-&gt;x + perso-&gt;w/2 - largeurfenetre/2yscroll = perso-&gt;y + perso-&gt;h/2 - hauteurfenetre/2</p><p id="r-304990" data-claire-element-id="304990">Et voilà !</p><h6 id="r-clamping" data-claire-element-id="304997">Clamping</h6><p id="r-304992" data-claire-element-id="304992">Nous avons besoin également de prendre une précaution. <br> Imaginons que notre perso soit très à gauche du monde. Si nous centrons la fenêtre de scrolling autour, alors une partie de cette fenêtre sortira du monde. <br> Avec les fonctions présentées depuis le début du tuto, il <strong>ne faut pas</strong> que cette fenêtre sorte du monde. Il faut qu'elle soit bloquée entièrement dans le monde.</p><p id="r-304993" data-claire-element-id="304993">Dans le jargon, si on empêche la fenêtre de sortir du monde, on dit qu'on la <em>clamp</em>.</p><aside id="r-304995" data-claire-element-id="304995" data-claire-semantic="information"><p id="r-304994" data-claire-element-id="304994">Si jamais la fonction de <em>clamping</em> modifie xscroll et yscroll pour la remettre dans l'écran, on aura alors le seul cas ou notre personnage ne sera pas forcément au centre du monde, mais pourra aller se coller contre le bord. En effet, la fenêtre de scrolling s'arrête, mais vous, rien ne vous empêche de continuer à marcher jusqu'au bord, donc de voir réellement votre personnage se déplacer à droite dans votre fenêtre. Ceci se voit bien dans les jeux vidéos quand on approche du bord du stage, c'est le seul cas ou on peut se coller au bord de l'écran.</p></aside><p id="r-304996" data-claire-element-id="304996">Cette méthode était donc à présenter pour notre culture, mais ce n'est pas celle que nous utiliserons à terme. Essayez-la quand même dans le code d'en bas, pour voir.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">
<span class="arrow"></span>
<span class="next">Scrolling automatique</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
<span class="next">Scrolling à sous-boîte limite</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Scrollingsous-botelimite"></a><h2>Scrolling à sous-boîte limite</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
<span class="arrow"></span>
<span class="next">Centre du monde !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
<span class="next">Code exemple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-scrolling-a-sous-boite-limite" data-claire-element-id="305041">Scrolling à sous-boîte limite</h4><p id="r-304999" data-claire-element-id="304999">Dans la majorité des jeux de plateforme, ou vu de dessus, le personnage peut se déplacer dans l'écran. Le scrolling ne se met à le suivre que s'il va "trop au bord".</p><p id="r-305000" data-claire-element-id="305000">Voyons quelques schémas pour comprendre.</p><figure id="r-305002" data-claire-element-id="305003"><img id="r-305001" data-claire-element-id="305001" src="./Tutoriel _ Tile Mapping_files/uploads.siteduzero.com_files_211001_212000_211822.png" alt="Image utilisateur"></figure><p id="r-305004" data-claire-element-id="305004">Nous reconnaissons le rectangle rouge : fenêtrage de scrolling, avec son point haut gauche qui est toujours xscroll et yscroll.</p><p id="r-305005" data-claire-element-id="305005">Nous définissons un rectangle jaune, à l'intérieur, que nous appellerons <strong>rectangle limite</strong>.</p><p id="r-305006" data-claire-element-id="305006">Le concept est simple : notre personnage peut se promener dans tout le rectangle jaune. Nous considérons son centre (au personnage). Si son centre est dans le rectangle limite, on ne scroll pas. Par contre, s'il en sort, on scroll de façon à le ramener dedans.</p><p id="r-305007" data-claire-element-id="305007">Il faudra alors calculer de combien on sort, en x et en y, et ajuster xscroll et yscroll de ces valeurs pour ramener notre personnage à la limite où il ne sort pas.</p><p id="r-305008" data-claire-element-id="305008">Avant de passer aux calculs, regardons notre dessin.</p><ul id="r-305015" data-claire-element-id="305015"><li id="r-305010" data-claire-element-id="305010"><p id="r-305009" data-claire-element-id="305009">La cas A est un rectangle jaune à égale distance dans les quatre directions au rectangle rouge. La conséquence, c'est que dès que le personnage arrive près du bord, il y a défilement. Cependant, si un ennemi arrive, comme on est près du bord, on aura peu de temps pour le voir.</p></li><li id="r-305012" data-claire-element-id="305012"><p id="r-305011" data-claire-element-id="305011">Le cas B est meilleur pour les jeux de plateforme où on avance à droite. Dès qu'on franchit le milieu, on défile. On voit ainsi bien les ennemis arriver. On peut revenir en arrière, et on ne défilera que si vraiment on va trop en arrière.</p></li><li id="r-305014" data-claire-element-id="305014"><p id="r-305013" data-claire-element-id="305013">Le cas C présente un rectangle réduit à une seule ligne. Conséquence, le personnage sera toujours au centre horizontalement, mais la caméra ne fera pas de bond avec le personnage au moment des sauts. Si on revient en arrière, la caméra suit immédiatement.</p></li></ul><p id="r-305016" data-claire-element-id="305016">Vous pouvez ajuster votre rectangle limite comme vous le souhaitez pour avoir la meilleure ergonomie possible.</p><p id="r-305017" data-claire-element-id="305017">Notez que le cas limite où le rectangle est réduit à un seul point, au centre de l'écran, nous ramène dans le cas "centre du monde" ci-dessus.</p><h6 id="r-calculs" data-claire-element-id="305040">Calculs</h6><p id="r-305018" data-claire-element-id="305018">Voici les données que nous avons :</p><ul id="r-305031" data-claire-element-id="305031"><li id="r-305020" data-claire-element-id="305020"><p id="r-305019" data-claire-element-id="305019">xcsroll, yscroll : coordonnées haut gauche du fenêtrage de scrolling (rectangle rouge) ;</p></li><li id="r-305022" data-claire-element-id="305022"><p id="r-305021" data-claire-element-id="305021">largeurfenetre, hauteurfenetre : largeur et hauteur de fenêtre de scrolling ;</p></li><li id="r-305024" data-claire-element-id="305024"><p id="r-305023" data-claire-element-id="305023">xlim,ylim : coordonnées relatives du point haut gauche du rectangle jaune par rapport à xscroll et ysroll : distance fixe entre ces deux points ;</p></li><li id="r-305026" data-claire-element-id="305026"><p id="r-305025" data-claire-element-id="305025">wlim, hlim : largeur et hauteur de la fenêtre jaune. Plus petite que la hauteur et largeur de la fenêtre rouge ;</p></li><li id="r-305028" data-claire-element-id="305028"><p id="r-305027" data-claire-element-id="305027">xperso, yperso : coordonnées haut gauche perso ;</p></li><li id="r-305030" data-claire-element-id="305030"><p id="r-305029" data-claire-element-id="305029">wperso, hperso : largeur et hauteur perso.</p></li></ul><p id="r-305032" data-claire-element-id="305032">Nous disions que si le centre du perso sort, alors on fait évoluer le scrolling. Donc tout ce qui compte pour le perso, c'est son centre.<br> Ce centre est défini par (cxperso,cyperso) de la façon suivante :<br>cxperso = xperso + wperso/2cyperso = yperso + hperso/2</p><p id="r-305033" data-claire-element-id="305033">Calculons les limites, à un instant donné, à ne pas dépasser. Cette limite évolue avec le scrolling.<br> Les coordonnées xlimmin et ylimin représenteront le coin haut gauche de la limite, et xlimmax et ylimmax le coin bas droit, dans le grand monde.</p><p id="r-305034" data-claire-element-id="305034">Pour le coin haut gauche, une simple addition suffit :<br>xlimmin = xscroll + xlimylimmin = yscroll + ylim</p><p id="r-305035" data-claire-element-id="305035">Pour le coin bas droit : c'est le coin haut gauche auquel on ajoute la largeur et la hauteur de la fenêtre de limite :<br>xlimmax = xlimmin + wlimylimmax = ylimmin + hlim</p><aside id="r-305037" data-claire-element-id="305037" data-claire-semantic="information"><p id="r-305036" data-claire-element-id="305036">Il suffit maintenant de vérifier si les coordonnées de notre centre ne sortent pas de ces limites. Et si c'est le cas, on ajuste. If suffira de 4 if, un pour chacune des 4 directions.</p></aside><pre id="r-305038" data-claire-element-id="305038"><code data-claire-semantic="c">if (cxperso&lt;xlimmin)
  xscroll -= (xlimmin-cxperso);
if (cyperso&lt;ylimmin)
  yscroll -= (ylimmin-cyperso);
if (cxperso&gt;xlimmax)
  xscroll += (cxperso-xlimmax);
if (cyperso&gt;ylimmax)
  yscroll += (cyperso-ylimmax);</code></pre><p id="r-305039" data-claire-element-id="305039">Une fois cette opération faite, on aura la garantie que notre sprite se trouve bien dans la zone jaune.<br> Cependant, si jamais notre fenêtre de scrolling est calculée hors du monde, il faut la <em>clamper</em> comme on a vu au dessus, et là, notre perso pourra donc se coller au bord.</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
<span class="arrow"></span>
<span class="next">Centre du monde !</span>
</a>
<a class="after" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
<span class="next">Code exemple</span>
<span class="arrow"></span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div><a name="Codeexemple"></a><h2>Code exemple</h2><div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
<span class="arrow"></span>
<span class="next">Scrolling à sous-boîte limite</span>
</a>
</div>
<hr class="top">
<div class="clear"></div> <div id="content" role="article">
<h4 id="r-code-exemple-5" data-claire-element-id="305099">Code exemple</h4><p id="r-305042" data-claire-element-id="305042">Voici maintenant l'heure de voir le code qui illustre ce que nous venons de voir.</p><p id="r-305043" data-claire-element-id="305043">Ouvrez et compilez le projet "prog6".</p><p id="r-305044" data-claire-element-id="305044">Cet exemple ressemble beaucoup à celui de la partie précédente : vous allez déplacer votre personnage vert dans le même monde, à la différence près que la caméra vous suivra.<br> Utilisez donc uniquement les touches de direction du clavier pour tester cet exemple.</p><p id="r-305045" data-claire-element-id="305045">Nous avons vu 2 types de scrolling, l'exemple illustre le second. <br> Nous avions vu que le premier cas pouvait être considéré à partir du premier cas avec un rectangle limite ramené à un point central.<br> Vous pourrez modifier les paramètres de la fonction FocusScrollBox appelée dans le main pour l'envisager.</p><p id="r-305046" data-claire-element-id="305046">Vous pouvez remarquer que j'ai modifié légèrement les fichiers fsprite.h et fmap.h par rapport à l'exemple précédent.</p><p id="r-305047" data-claire-element-id="305047">Dans la mesure ou Map aura besoin de Sprite, et Sprite aura besoin de Map, nous pouvons voir :</p><ul id="r-305054" data-claire-element-id="305054"><li id="r-305050" data-claire-element-id="305050"><p id="r-305048" data-claire-element-id="305048">en haut de fmap.h</p><pre id="r-305049" data-claire-element-id="305049"><code data-claire-semantic="c">typedef struct Ssprite Sprite;</code></pre></li><li id="r-305053" data-claire-element-id="305053"><p id="r-305051" data-claire-element-id="305051">en haut de fsprite.h</p><pre id="r-305052" data-claire-element-id="305052"><code data-claire-semantic="c">typedef struct Smap Map;</code></pre></li></ul><p id="r-305055" data-claire-element-id="305055">Regardons le main, dans le fichier prog6.c</p><pre id="r-305056" data-claire-element-id="305056"><code data-claire-semantic="c">int main(int argc,char** argv)
{
	Sprite* perso;
	SDL_Surface* screen;
	Map* carte;
	Input in;
	InitEvents(&amp;in);
	SDL_Init(SDL_INIT_VIDEO);		// preapare SDL
	screen = SDL_SetVideoMode(LARGEUR_FENETRE,HAUTEUR_FENETRE,32,SDL_HWSURFACE|SDL_DOUBLEBUF);
	carte = ChargerMap("level2.txt",LARGEUR_FENETRE,HAUTEUR_FENETRE);
	perso = InitialiserSprite(150,150,24,32,carte);
	FocusScrollBox(carte,perso,200,150,400,300);
	while(!in.key[SDLK_ESCAPE])
	{
		UpdateEvents(&amp;in);
		Evolue(&amp;in,perso);
		AfficherMap(carte,screen);
		AfficherSprite(perso,screen);
		SDL_Flip(screen);
		SDL_Delay(5);
	}
	LibererMap(carte);
	SDL_Quit();
	return 0;
}</code></pre><p id="r-305057" data-claire-element-id="305057">Comme dans l'exemple précédent, j'initialise une carte, puis un perso.<br> Ensuite, j'appelle la ligne suivante :</p><pre id="r-305058" data-claire-element-id="305058"><code data-claire-semantic="c">FocusScrollBox(carte,perso,200,150,400,300);</code></pre><p id="r-305059" data-claire-element-id="305059">Cette ligne va simplement dire qu'à partir de maintenant, le scrolling sera automatique sur la <em>carte </em>autour du sprite <em>perso</em> avec un rectangle limite de 200,150,400,300 dans le repère de la fenêtre.</p><p id="r-305060" data-claire-element-id="305060">Une fois cette ligne posée, rien à changer de plus dans le main.</p><p id="r-305061" data-claire-element-id="305061">Voyons maintenant la structure Map dans le fichier fmap.h</p><pre id="r-305062" data-claire-element-id="305062"><code data-claire-semantic="c">struct Smap
{
	int LARGEUR_TILE,HAUTEUR_TILE;
	int nbtilesX,nbtilesY;
	SDL_Surface* tileset;
	TileProp* props;
	tileindex** schema;
	int nbtiles_largeur_monde,nbtiles_hauteur_monde;
	int largeur_fenetre,hauteur_fenetre;
// scroll
	int xscroll,yscroll;
	Sprite* tofocus;
	SDL_Rect rectlimitscroll;
};</code></pre><p id="r-305063" data-claire-element-id="305063">Les nouveaux paramètres en bas sont un pointeur vers le sprite à focaliser, et le rectangle limite.<br> Tout ce que va faire la fonction FocusScrollBox, c'est remplir ces paramètres.</p><pre id="r-305064" data-claire-element-id="305064"><code data-claire-semantic="c">int FocusScrollBox(Map* m,Sprite* sp,int x,int y,int w,int h)
{
	m-&gt;tofocus = sp;
	m-&gt;rectlimitscroll.x = x;
	m-&gt;rectlimitscroll.y = y;
	m-&gt;rectlimitscroll.w = w;
	m-&gt;rectlimitscroll.h = h;
	return 0;
}</code></pre><p id="r-305065" data-claire-element-id="305065">C'est finalement la fonction AfficherMap qui va se charger de mettre le scrolling à jour.</p><pre id="r-305066" data-claire-element-id="305066"><code data-claire-semantic="c">int AfficherMap(Map* m,SDL_Surface* screen)
{
	int i,j;
	SDL_Rect Rect_dest;
	int numero_tile;
	int minx,maxx,miny,maxy;
	UpdateScroll(m);
	minx = m-&gt;xscroll / m-&gt;LARGEUR_TILE-1;
	miny = m-&gt;yscroll / m-&gt;HAUTEUR_TILE-1;
	maxx = (m-&gt;xscroll + m-&gt;largeur_fenetre)/m-&gt;LARGEUR_TILE;
	maxy = (m-&gt;yscroll + m-&gt;hauteur_fenetre)/m-&gt;HAUTEUR_TILE;
	for(i=minx;i&lt;=maxx;i++)
	{
		for(j=miny;j&lt;=maxy;j++)
		{
			Rect_dest.x = i*m-&gt;LARGEUR_TILE - m-&gt;xscroll;
			Rect_dest.y = j*m-&gt;HAUTEUR_TILE - m-&gt;yscroll;
			if (i&lt;0 || i&gt;=m-&gt;nbtiles_largeur_monde || j&lt;0 || j&gt;=m-&gt;nbtiles_hauteur_monde)
				numero_tile = 0;
			else
				numero_tile = m-&gt;schema[i][j];&lt;code type="c"&gt;&lt;code type="c"&gt;
			SDL_BlitSurface(m-&gt;tileset,&amp;(m-&gt;props[numero_tile].R),screen,&amp;Rect_dest);
		}
	}
	return 0;
}</code></pre><p id="r-305067" data-claire-element-id="305067">Vous pouvez constater un appel à une fonction UpdateScroll, qui s'en occupera.</p><p id="r-305068" data-claire-element-id="305068">Dans cette fonction :</p><pre id="r-305069" data-claire-element-id="305069"><code data-claire-semantic="c">int UpdateScroll(Map* m)
{
	int cxperso,cyperso,xlimmin,xlimmax,ylimmin,ylimmax;
	if (m-&gt;tofocus==NULL)
		return -1;
	cxperso = m-&gt;tofocus-&gt;x + m-&gt;tofocus-&gt;w/2;
	cyperso = m-&gt;tofocus-&gt;y + m-&gt;tofocus-&gt;h/2;
	xlimmin = m-&gt;xscroll + m-&gt;rectlimitscroll.x;
	ylimmin = m-&gt;yscroll + m-&gt;rectlimitscroll.y;
	xlimmax = xlimmin + m-&gt;rectlimitscroll.w;
	ylimmax = ylimmin + m-&gt;rectlimitscroll.h;
	if (cxperso&lt;xlimmin)
		m-&gt;xscroll -= (xlimmin-cxperso);
	if (cyperso&lt;ylimmin)
		m-&gt;yscroll -= (ylimmin-cyperso);
	if (cxperso&gt;xlimmax)
		m-&gt;xscroll += (cxperso-xlimmax);
	if (cyperso&gt;ylimmax)
		m-&gt;yscroll += (cyperso-ylimmax);
	ClampScroll(m);
	return 0;
}</code></pre><p id="r-305070" data-claire-element-id="305070">Nous calculons les nouvelles positions de xscroll et yscroll en fonction du personnage et de la boîte limite, avec les formules vi ci dessus.<br> Puis nous appelons la fonction ClampScroll</p><pre id="r-305071" data-claire-element-id="305071"><code data-claire-semantic="c">void ClampScroll(Map* m)
{
	if (m-&gt;xscroll&lt;0)
		m-&gt;xscroll=0;
	if (m-&gt;yscroll&lt;0)
		m-&gt;yscroll=0;
	if (m-&gt;xscroll&gt;m-&gt;nbtiles_largeur_monde*m-&gt;LARGEUR_TILE-m-&gt;largeur_fenetre-1)
		m-&gt;xscroll=m-&gt;nbtiles_largeur_monde*m-&gt;LARGEUR_TILE-m-&gt;largeur_fenetre-1;
	if (m-&gt;yscroll&gt;m-&gt;nbtiles_hauteur_monde*m-&gt;HAUTEUR_TILE-m-&gt;hauteur_fenetre-1)
		m-&gt;yscroll=m-&gt;nbtiles_hauteur_monde*m-&gt;HAUTEUR_TILE-m-&gt;hauteur_fenetre-1;
}</code></pre><p id="r-305072" data-claire-element-id="305072">Cette fonction envisage donc le cas ou la fenêtre de scrolling dépasserait à l'extérieur du monde, et si c'est le cas, elle la remet dans le monde correctement : elle l'empêche de sortir.</p><p id="r-305073" data-claire-element-id="305073">Notre scrolling automatique est maintenant en place.<br> A l'utilisation, il suffira uniquement d'appeler la fonction FocusScrollBox une fois pour toutes et le scrolling sera automatique !<br> Plus besoin de se casser la tête, de mettre en place plein de lignes dans le main.</p><p id="r-305074" data-claire-element-id="305074">Un seul appel de FocusScrollBox , et le tour est joué !</p><p id="r-305075" data-claire-element-id="305075">A la fin de cette partie, les collisions avec le décor sont gérées, le scrolling est automatique, et tout cela avec peu d'appels de fonctions.<br> Si les techniques ont pu vous paraître compliquées, rappelez vous qu'une fois en place, <strong>l'utilisation</strong> est simple.</p><p id="r-305076" data-claire-element-id="305076">Après tout, pour le moment, nous n'avons dans notre header fmap.h que 6 fonctions...</p><p id="r-305077" data-claire-element-id="305077">Ceci est la troisième version du tutorial sur le TileMapping.</p><p id="r-305078" data-claire-element-id="305078">Gardez bien en tête que même si la technique vous paraît complexe, une fois les outils en place, l'utilisation, elle, ne l'est pas trop. Il suffit de regarder la taille du <code data-claire-semantic="c">main</code> pour le comprendre.</p><p id="r-305079" data-claire-element-id="305079">Voici ce qui sera prévu dans les parties suivantes :</p><ul id="r-305086" data-claire-element-id="305086"><li id="r-305081" data-claire-element-id="305081"><p id="r-305080" data-claire-element-id="305080">remplacer cet affreux carré vert par un personnage animé ;</p></li><li id="r-305083" data-claire-element-id="305083"><p id="r-305082" data-claire-element-id="305082">gérer un champ de gravité, pour pouvoir faire des sauts et avancer de façon plus réaliste ;</p></li><li id="r-305085" data-claire-element-id="305085"><p id="r-305084" data-claire-element-id="305084">faire un fond de stage qui défilera moins vite que les tiles.</p></li></ul><p id="r-305087" data-claire-element-id="305087">Nous pourrons aussi voir :</p><ul id="r-305096" data-claire-element-id="305096"><li id="r-305089" data-claire-element-id="305089"><p id="r-305088" data-claire-element-id="305088">comment animer des tiles (eau, lave qui bouge), comment avoir des tiles semi transparents : une barrière par exemple qui laisserait apparaitre le fond entre ses barreaux :</p></li><li id="r-305091" data-claire-element-id="305091"><p id="r-305090" data-claire-element-id="305090">comment rajouter des ennemis, leur donner un comportement ;</p></li><li id="r-305093" data-claire-element-id="305093"><p id="r-305092" data-claire-element-id="305092">comment interagir avec le monde (casser des briques, prendre des bonus...) ;</p></li><li id="r-305095" data-claire-element-id="305095"><p id="r-305094" data-claire-element-id="305094">comment mettre des tiles qui masquent en partie notre personnage : par exemple il pourra passer derrière un bosquet et nous ne verrons alors plus ses jambes.</p></li></ul><p id="r-305097" data-claire-element-id="305097">Nous verrons cela avec le temps, en fonction de mes disponibilité, de vos commentaires, de vos demandes par message privé ou sur le <a href="http://www.siteduzero.com/forum-83-471876-p1-tutoriel-tile-mapping.html">topic officiel du tutoriel</a>.</p><p id="r-305098" data-claire-element-id="305098">À bientôt pour la suite !</p>
<aside class="aside-menu">
<ul class="content-menu" role="navigation">
<li class="tuto">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping">Tile Mapping</a>
</li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 1</span>
Mise en place du Tile Mapping
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-generale-2">Présentation générale</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/problematique-1">
Problématique
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/technique-de-l-image-figee">
Technique de l'image figée
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/presentation-du-tile-mapping">
Présentation du tile mapping
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/cout-memoire">
Coût mémoire
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/proprietes-des-tiles">Propriétés des tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-d-un-fichier-texte-pour-un-niveau">
Structure d'un fichier texte pour un niveau
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/structure-dans-le-programme">
Structure dans le programme
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-1">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-1">Scrolling</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/l-idee-de-l-image-geante">
L'idée de l'image géante
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/le-fenetrage">
Le fenêtrage
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-2">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/un-editeur">Un Editeur</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/utilisation-de-l-editeur">
Utilisation de l'éditeur
</a>
</li>
</ul> </li></ul> </li>
<li class="chapter">
 
<a class="chapterLink" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).next().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).next().removeClass(&#39;box-shadow-summary&#39;);">
<span>Partie 2</span>
Gestion de personnage
</a>
<a class="chapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#" onmouseover="$(this).addClass(&#39;box-shadow-summary&#39;).prev().addClass(&#39;box-shadow-summary&#39;);" onmouseout="$(this).removeClass(&#39;box-shadow-summary&#39;).prev().removeClass(&#39;box-shadow-summary&#39;);">
<span>+</span>
</a>
 
<ul class="subchapters">
<li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/simple-personnage">Simple personnage</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/qu-est-ce-qu-un-personnage">
Qu'est-ce qu'un personnage ?
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/premiere-approche-de-collision-avec-le-decor">
Première approche de collision avec le décor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/algorithme-de-deplacement">
Algorithme de déplacement
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-3">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/insertion-dans-un-monde-de-tiles">Insertion dans un monde de Tiles</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/la-nouvelle-fonction-collisiondecor">
La nouvelle fonction CollisionDecor
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/les-deplacements-rapides">
Les déplacements rapides
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-4">
Code exemple
</a>
</li>
</ul> </li> <li class="subchapter">
<div>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-automatique">Scrolling automatique</a>
<a class="subchapterOpen" href="http://sdz.tdct.org/sdz/ile-mapping.html#">
<span>+</span>
</a>
</div>
<ul class="subchapter-parts">
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/centre-du-monde">
Centre du monde !
</a>
</li>
<li>
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
Scrolling à sous-boîte limite
</a>
</li>
<li class="active">
<a href="http://62.4.17.167/informatique/tutoriels/tile-mapping/code-exemple-5">
Code exemple
</a>
</li>
</ul>
</li>
</ul>
</li>

</ul>
</aside>
</div>
<div id="content-bottom-menu"></div>
<hr>
<div class="paginate-tuto">
<a class="before" href="http://62.4.17.167/informatique/tutoriels/tile-mapping/scrolling-a-sous-boite-limite">
<span class="arrow"></span>
<span class="next">Scrolling à sous-boîte limite</span>
</a>
</div>
<hr class="bottom">
<div class="clear"></div> <div class="adBan">
<script type="text/javascript">
    if (window.innerWidth >= 728)
    {
        document.write('<div id="div-gpt-ad-1350977194635-8" class="megaban"></div>');
        googletag.cmd.push(function() {
            googletag.display('div-gpt-ad-1350977194635-8');
        });
    }
            else
        {
            document.write('<div id="div-gpt-ad-1350977284180-8" class="miniban"></div>');
            googletag.cmd.push(function() {
                googletag.display('div-gpt-ad-1350977284180-8');
            });
        }
    </script><div id="div-gpt-ad-1350977194635-8" class="megaban"></div>
</div>
<div class="clear"></div>


</body><!-- Mirrored from 62.4.17.167/sdz/sdz/ile-mapping.html by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 27 Oct 2013 02:53:39 GMT --></html>